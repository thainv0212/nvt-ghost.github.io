<!DOCTYPE html>
<html ⚡>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">

    <title>OpenCV - Grayscale, Binary Image, Adaptive Threshold</title>

    <meta name="description" content="Biến đổi ảnh màu về thành ảnh xám (grayscale image) và ảnh đen trắng (black and white), sử dụng apdative threshold." />
    <link rel="canonical" href="../index.html" />
    <meta name="referrer" content="no-referrer-when-downgrade" />
    
    <meta property="og:site_name" content="GMO-Z.com Vietnam Lab Center Technology Blog" />
    <meta property="og:type" content="article" />
    <meta property="og:title" content="OpenCV - Grayscale, Binary Image, Adaptive Threshold" />
    <meta property="og:description" content="Biến đổi ảnh màu về thành ảnh xám (grayscale image) và ảnh đen trắng (black and white), sử dụng apdative threshold." />
    <meta property="og:url" content="https://blog.vietnamlab.vn/xu-ly-anh-voi-opencv-tut-2-chuyen-doi-anh-mau/" />
    <meta property="og:image" content="https://drive.google.com/uc?id&#x3D;1combYaowazUEQhEZUHtxNJGvaLoPRgQS&amp;export&#x3D;download" />
    <meta property="article:published_time" content="2018-02-27T01:39:50.000Z" />
    <meta property="article:modified_time" content="2019-01-11T10:14:59.000Z" />
    <meta property="article:tag" content="OpenCV" />
    <meta property="article:tag" content="grayscale" />
    <meta property="article:tag" content="binary image" />
    <meta property="article:tag" content="threshold" />
    <meta property="article:tag" content="convert color" />
    <meta property="article:tag" content="adaptive threshold" />
    
    <meta property="article:publisher" content="https://www.facebook.com/vietnamlab.vn" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="OpenCV - Grayscale, Binary Image, Adaptive Threshold" />
    <meta name="twitter:description" content="Biến đổi ảnh màu về thành ảnh xám (grayscale image) và ảnh đen trắng (black and white), sử dụng apdative threshold." />
    <meta name="twitter:url" content="https://blog.vietnamlab.vn/xu-ly-anh-voi-opencv-tut-2-chuyen-doi-anh-mau/" />
    <meta name="twitter:image" content="https://drive.google.com/uc?id&#x3D;1combYaowazUEQhEZUHtxNJGvaLoPRgQS&amp;export&#x3D;download" />
    <meta name="twitter:label1" content="Written by" />
    <meta name="twitter:data1" content="H.M.D" />
    <meta name="twitter:label2" content="Filed under" />
    <meta name="twitter:data2" content="OpenCV, grayscale, binary image, threshold, convert color, adaptive threshold" />
    <meta property="og:image:width" content="900" />
    <meta property="og:image:height" content="300" />
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "GMO-Z.com Vietnam Lab Center Technology Blog",
        "url": "https://blog.vietnamlab.vn/",
        "logo": {
            "@type": "ImageObject",
            "url": "https://blog.vietnamlab.vn/favicon.ico",
            "width": 48,
            "height": 48
        }
    },
    "author": {
        "@type": "Person",
        "name": "H.M.D",
        "url": "https://blog.vietnamlab.vn/author/duonghm/",
        "sameAs": []
    },
    "headline": "OpenCV - Grayscale, Binary Image, Adaptive Threshold",
    "url": "https://blog.vietnamlab.vn/xu-ly-anh-voi-opencv-tut-2-chuyen-doi-anh-mau/",
    "datePublished": "2018-02-27T01:39:50.000Z",
    "dateModified": "2019-01-11T10:14:59.000Z",
    "image": {
        "@type": "ImageObject",
        "url": "https://drive.google.com/uc?id=1combYaowazUEQhEZUHtxNJGvaLoPRgQS&export=download",
        "width": 900,
        "height": 300
    },
    "keywords": "OpenCV, grayscale, binary image, threshold, convert color, adaptive threshold",
    "description": "Series bài viết\n * Tut 1: Cài đặt OpenCV\n   [https://blog.vietnamlab.vn/2017/12/22/xu-ly-anh-voi-opencv-tut-1-cai-dat-opencv/]\n * Tut 2: Chuyển đổi ảnh màu\n   [https://blog.vietnamlab.vn/2018/02/27/xu-ly-anh-voi-opencv-tut-2-chuyen-doi-anh-mau/]\n * Tut 3: Phương pháp lọc ảnh\n   [https://blog.vietnamlab.vn/2018/05/30/xu-ly-anh-voi-opencv-tut3/]\n * Tut 4: Xác định viền trong ảnh\n   [https://blog.vietnamlab.vn/2018/10/09/xu-ly-anh-voi-opencv/]\n\nMục tiêu bài viết\nBài viết sẽ giúp các bạn có thể thực",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://blog.vietnamlab.vn/"
    }
}
    </script>

    <meta name="generator" content="Ghost 3.36" />
    <link rel="alternate" type="application/rss+xml" title="GMO-Z.com Vietnam Lab Center Technology Blog" href="../../rss/index.html" />

    <style amp-custom>
    *,
    *::before,
    *::after {
        box-sizing: border-box;
    }

    html {
        overflow-x: hidden;
        overflow-y: scroll;
        font-size: 62.5%;
        -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
    }

    body {
        min-height: 100vh;
        margin: 0;
        padding: 0;
        color: #3a4145;
        font-family: -apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Open Sans,Helvetica Neue,sans-serif;
        font-size: 1.7rem;
        line-height: 1.55em;
        font-weight: 400;
        font-style: normal;
        background: #fff;
        scroll-behavior: smooth;
        overflow-x: hidden;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
    }

    p,
    ul,
    ol,
    li,
    dl,
    dd,
    hr,
    pre,
    form,
    table,
    video,
    figure,
    figcaption,
    blockquote {
        margin: 0;
        padding: 0;
    }

    ul[class],
    ol[class] {
        padding: 0;
        list-style: none;
    }

    img {
        display: block;
        max-width: 100%;
    }

    input,
    button,
    select,
    textarea {
        font: inherit;
        -webkit-appearance: none;
    }

    fieldset {
        margin: 0;
        padding: 0;
        border: 0;
    }

    label {
        display: block;
        font-size: 0.9em;
        font-weight: 700;
    }

    hr {
        position: relative;
        display: block;
        width: 100%;
        height: 1px;
        border: 0;
        border-top: 1px solid currentcolor;
        opacity: 0.1;
    }

    ::selection {
        text-shadow: none;
        background: #cbeafb;
    }

    mark {
        background-color: #fdffb6;
    }

    small {
        font-size: 80%;
    }

    sub,
    sup {
        position: relative;
        font-size: 75%;
        line-height: 0;
        vertical-align: baseline;
    }
    sup {
        top: -0.5em;
    }
    sub {
        bottom: -0.25em;
    }

    ul li + li {
        margin-top: 0.6em;
    }

    a {
        color: #1292EE;
        text-decoration-skip-ink: auto;
    }

    h1,
    h2,
    h3,
    h4,
    h5,
    h6 {
        margin: 0;
        font-weight: 700;
        color: #121212;
        line-height: 1.4em;
    }

    h1 {
        font-size: 3.4rem;
        line-height: 1.1em;
    }

    h2 {
        font-size: 2.4rem;
        line-height: 1.2em;
    }

    h3 {
        font-size: 1.8rem;
    }

    h4 {
        font-size: 1.7rem;
    }

    h5 {
        font-size: 1.6rem;
    }

    h6 {
        font-size: 1.6rem;
    }

    amp-img {
        height: 100%;
        width: 100%;
        max-width: 100%;
        max-height: 100%;
    }

    amp-img img {
        object-fit: cover;
    }

    .page-header {
        padding: 50px 5vmin 30px;
        text-align: center;
        font-size: 2rem;
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }

    .page-header a {
        color: #121212;
        font-weight: 700;
        text-decoration: none;
        font-size: 1.6rem;
        letter-spacing: -0.1px;
    }

    .post {
        max-width: 680px;
        margin: 0 auto;
    }

    .post-header {
        margin: 0 5vmin 5vmin;
        text-align: center;
    }

    .post-meta {
        margin: 1rem 0 0 0;
        text-transform: uppercase;
        color: #738a94;
        font-weight: 500;
        font-size: 1.3rem;
    }

    .post-image {
        margin: 0 0 5vmin;
    }

    .post-image img {
        display: block;
        width: 100%;
        height: auto;
    }

    .post-content {
        padding: 0 5vmin;
    }

    .post-content > * + * {
        margin-top: 1.5em;
    }

    .post-content [id]:not(:first-child) {
        margin: 2em 0 0;
    }

    .post-content > [id] + * {
        margin-top: 1rem;
    }

    .post-content [id] + .kg-card,
    .post-content blockquote + .kg-card {
        margin-top: 40px;
    }

    .post-content > ul,
    .post-content > ol,
    .post-content > dl {
        padding-left: 1.9em;
    }

    .post-content hr {
        margin-top: 40px;
    }

    .post .post-content hr + * {
        margin-top: 40px;
    }

    .post-content amp-img {
        background-color: #f8f8f8;
    }

    .post-content blockquote {
        position: relative;
        font-style: italic;
    }

    .post-content blockquote::before {
        content: "";
        position: absolute;
        left: -1.5em;
        top: 0;
        bottom: 0;
        width: 0.3rem;
        background: #000;
    }

    .post-content :not(.kg-card):not([id]) + .kg-card {
        margin-top: 40px;
    }

    .post-content .kg-card + :not(.kg-card) {
        margin-top: 40px;
    }

    .kg-card figcaption {
        padding: 1.5rem 1.5rem 0;
        text-align: center;
        font-weight: 500;
        font-size: 1.3rem;
        line-height: 1.4em;
        opacity: 0.6;
    }

    .kg-card figcaption strong {
        color: rgba(0,0,0,0.8);
    }

    .post-content :not(pre) code {
        vertical-align: middle;
        padding: 0.15em 0.4em 0.15em;
        border: #e1eaef 1px solid;
        font-weight: 400;
        font-size: 0.9em;
        line-height: 1em;
        color: #dc0050;
        background: #f0f6f9;
        border-radius: 0.25em;
    }

    .post-content > pre {
        overflow: scroll;
        padding: 16px 20px;
        color: #fff;
        background: #1F2428;
        border-radius: 5px;
        box-shadow: 0 2px 6px -2px rgba(0,0,0,.1), 0 0 1px rgba(0,0,0,.4);
    }

    .kg-embed-card {
        display: flex;
        flex-direction: column;
        align-items: center;
        width: 100%;
    }

    .kg-image-card img {
        margin: auto;
    }

    .kg-gallery-card + .kg-gallery-card {
        margin-top: 0.75em;
    }

    .kg-gallery-container {
        position: relative;
    }

    .kg-gallery-row {
        display: flex;
        flex-direction: row;
        justify-content: center;
    }

    .kg-gallery-image {
        width: 100%;
        height: 100%;
    }

    .kg-gallery-row:not(:first-of-type) {
        margin: 0.75em 0 0 0;
    }

    .kg-gallery-image:not(:first-of-type) {
        margin: 0 0 0 0.75em;
    }

    .kg-bookmark-card,
    .kg-bookmark-publisher {
        position: relative;
    }

    .kg-bookmark-container,
    .kg-bookmark-container:hover {
        display: flex;
        flex-wrap: wrap;
        flex-direction: row-reverse;
        color: currentColor;
        background: rgba(255,255,255,0.6);
        font-family: -apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Open Sans,Helvetica Neue,sans-serif;
        text-decoration: none;
        border-radius: 5px;
        box-shadow: 0 2px 6px -2px rgba(0, 0, 0, 0.1), 0 0 1px rgba(0, 0, 0, 0.4);
        overflow: hidden;
    }

    .kg-bookmark-content {
        flex-basis: 0;
        flex-grow: 999;
        padding: 20px;
        order: 1;
    }

    .kg-bookmark-title {
        font-weight: 600;
        font-size: 1.5rem;
        line-height: 1.3em;
    }

    .kg-bookmark-description {
        display: -webkit-box;
        max-height: 45px;
        margin: 0.5em 0 0 0;
        font-size: 1.4rem;
        line-height: 1.55em;
        overflow: hidden;
        opacity: 0.8;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
    }

    .kg-bookmark-metadata {
        margin-top: 20px;
    }

    .kg-bookmark-metadata {
        display: flex;
        align-items: center;
        font-weight: 500;
        font-size: 1.3rem;
        line-height: 1.3em;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }

    .kg-bookmark-description {
        display: -webkit-box;
        -webkit-box-orient: vertical;
        -webkit-line-clamp: 2;
        overflow: hidden;
    }

    .kg-bookmark-metadata amp-img {
        width: 18px;
        height: 18px;
        max-width: 18px;
        max-height: 18px;
        margin-right: 10px;
    }

    .kg-bookmark-thumbnail {
        display: flex;
        flex-basis: 20rem;
        flex-grow: 1;
        justify-content: flex-end;
    }

    .kg-bookmark-thumbnail amp-img {
        max-height: 200px;
    }

    .kg-bookmark-author {
        white-space: nowrap;
        text-overflow: ellipsis;
        overflow: hidden;
    }

    .kg-bookmark-publisher::before {
        content: "•";
        margin: 0 .5em;
    }

    .kg-width-full.kg-card-hascaption {
        display: grid;
        grid-template-columns: inherit;
    }

    .post-content table {
        border-collapse: collapse;
        width: 100%;
    }

    .post-content th {
        padding: 0.5em 0.8em;
        text-align: left;
        font-size: .75em;
        text-transform: uppercase;
    }

    .post-content td {
        padding: 0.4em 0.7em;
    }

    .post-content tbody tr:nth-child(2n + 1) {
        background-color: rgba(0,0,0,0.1);
        padding: 1px;
    }

    .post-content tbody tr:nth-child(2n + 2) td:last-child {
        box-shadow:
            inset 1px 0 rgba(0,0,0,0.1),
            inset -1px 0 rgba(0,0,0,0.1);
    }

    .post-content tbody tr:nth-child(2n + 2) td {
        box-shadow: inset 1px 0 rgba(0,0,0,0.1);
    }

    .post-content tbody tr:last-child {
        border-bottom: 1px solid rgba(0,0,0,.1);
    }

    .page-footer {
        padding: 60px 5vmin;
        margin: 60px auto 0;
        text-align: center;
        background-color: #f8f8f8;
    }

    .page-footer h3 {
        margin: 0.5rem 0 0 0;
    }

    .page-footer p {
        max-width: 500px;
        margin: 1rem auto 1.5rem;
        font-size: 1.7rem;
        line-height: 1.5em;
        color: rgba(0,0,0,0.6)
    }

    .powered {
        display: inline-flex;
        align-items: center;
        margin: 30px 0 0;
        padding: 6px 9px 6px 6px;
        border: rgba(0,0,0,0.1) 1px solid;
        font-size: 12px;
        line-height: 12px;
        letter-spacing: -0.2px;
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Roboto", "Oxygen", "Ubuntu", "Cantarell", "Fira Sans", "Droid Sans", "Helvetica Neue", sans-serif;
        font-weight: 500;
        color: #222;
        text-decoration: none;
        background: #fff;
        border-radius: 6px;
    }

    .powered svg {
        height: 16px;
        width: 16px;
        margin: 0 6px 0 0;
    }

    @media (max-width: 600px) {
        body {
            font-size: 1.6rem;
        }
        h1 {
            font-size: 3rem;
        }

        h2 {
            font-size: 2.2rem;
        }
    }

    @media (max-width: 400px) {
        h1 {
            font-size: 2.6rem;
            line-height: 1.15em;
        }
        h2 {
            font-size: 2rem;
            line-height: 1.2em;
        }
        h3 {
            font-size: 1.7rem;
        }
    }
    </style>

    <style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style><noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript>
    <script async src="https://cdn.ampproject.org/v0.js"></script>

    

</head>

<body class="amp-template">
    <header class="page-header">
        <a href="../../index.html">
                GMO-Z.com Vietnam Lab Center Technology Blog
        </a>
    </header>

    <main class="content" role="main">
        <article class="post">

            <header class="post-header">
                <h1 class="post-title">Xử lý ảnh với OpenCV - Tut 2: Chuyển đổi ảnh màu</h1>
                <section class="post-meta">
                    H.M.D -
                    <time class="post-date" datetime="2018-02-27">27 Feb 2018</time>
                </section>
            </header>
            <figure class="post-image">
                <amp-img src="https://drive.google.com/uc?id&#x3D;1combYaowazUEQhEZUHtxNJGvaLoPRgQS&amp;export&#x3D;download" width="600" height="340" layout="responsive"></amp-img>
            </figure>
            <section class="post-content">

                <h4 id="seriesbivit">Series bài viết</h4>
<ul>
<li><a href="https://blog.vietnamlab.vn/2017/12/22/xu-ly-anh-voi-opencv-tut-1-cai-dat-opencv/">Tut 1: Cài đặt OpenCV</a></li>
<li><a href="https://blog.vietnamlab.vn/2018/02/27/xu-ly-anh-voi-opencv-tut-2-chuyen-doi-anh-mau/">Tut 2: Chuyển đổi ảnh màu</a></li>
<li><a href="https://blog.vietnamlab.vn/2018/05/30/xu-ly-anh-voi-opencv-tut3/">Tut 3: Phương pháp lọc ảnh</a></li>
<li><a href="https://blog.vietnamlab.vn/2018/10/09/xu-ly-anh-voi-opencv/">Tut 4: Xác định viền trong ảnh</a></li>
</ul>
<h3 id="mctiubivit">Mục tiêu bài viết</h3>
<p>Bài viết sẽ giúp các bạn có thể thực hiện một số phép xử lý ảnh phổ biến với OpenCV trên C++ bắt đầu bằng việc biến đổi ảnh màu về thành ảnh xám (grayscale image) và ảnh đen trắng (black and white).</p>
<p><strong>Mỗi một mục được trình bày nhằm giải đáp bốn câu hỏi chính</strong></p>
<ul>
<li><strong>What</strong>: Cái gì? Kỹ thuật này cho ra kết quả như thế nào.</li>
<li><strong>Why</strong>: Tại sao? Kỹ thuật này được ứng dụng trong trường hợp nào.</li>
<li><strong>How</strong>: Như thế nào? Cách giải quyết trên mặt lý thuyết.</li>
<li><strong>Implement</strong>: Cách cài đặt.</li>
</ul>
<h4 id="1bininhxmgrayscaleconvert">1. Biến đổi ảnh xám (Grayscale convert)</h4>
<p><strong>What ?</strong><br />
Đưa vào một ảnh màu, bạn sẽ thu được một ảnh xám.<br />
<amp-img src="https://i.imgur.com/4KpRfBP.png" alt="img1" width="900" height="600" layout="responsive"></amp-img></p>
<p><strong>Why ?</strong><br />
Trong xử lý ảnh, việc chuyển đổi ảnh màu sang ảnh xám là công việc vô cùng phổ biến.<br />
Ảnh màu thực chất chỉ là tập hợp của những ma trận số có cùng kích thước (xem lại <a href="https://vietnamlab.vn/blog/2017/12/22/xu-ly-anh-voi-opencv-tut-1-cai-dat-opencv/">phần 1</a>). Khi muốn xử lý thông tin trên ảnh, sẽ dễ dàng hơn nếu ta chỉ xử lý dữ liệu trên một ma trận số thay vì nhiều ma trận số. Việc biến đổi ảnh màu về ảnh số (Grayscale converting) xuất hiện vì mục đích trên - biến đổi thông tin ảnh về một ma trận số hai chiều duy nhất.<br />
<amp-img src="https://i.imgur.com/W6HQOgS.png" alt="img_2" width="400" height="263" layout="responsive"></amp-img></p>
<p><strong>How ?</strong><br />
Giả sử, hình ảnh của bạn được lưu trữ dưới dạng RGB (Red-Green-Blue). Điều này có nghĩa bạn có ba ma trận xám tương ứng cho màu Red, Green, Blue. Công việc của bạn là tìm cách tổng hợp ba ma trận này về thành một ma trận duy nhất. Một trong số các công thức phổ biến để thực hiện việc đó là<br />
<strong>Y = 0.2126R + 0.7152G + 0.0722B</strong><br />
Trong đó:</p>
<ul>
<li>Y: ma trận xám cần tìm</li>
<li>R: ma trận xám đỏ của ảnh</li>
<li>G: ma trận xám lục của ảnh</li>
<li>B: ma trận xám lam của ảnh</li>
</ul>
<p>Nếu bạn chưa quen về việc thực hiện phép toán trên ma trận, hãy hình dung Y, R, G, B là giá trị mức xám trên các ô có tọa độ giống nhau.</p>
<p><strong>Implement</strong><br />
<strong>- Cách 1: Đọc trực tiếp ảnh dưới dạng ảnh xám</strong></p>
<pre><code class="language-cpp">#include&lt;opencv2\opencv.hpp&gt;

using namespace cv;

int main(){
	Mat img = imread("img_sample.png", CV_LOAD_IMAGE_GRAYSCALE);
	imshow("Sample", img);	
	waitKey(0);
	return 0;
}
</code></pre>
<p>Trong đoạn code trên, việc chuyển đổi ảnh sang dạng xám ngay từ lúc đọc ảnh vào bằng cách truyền thêm tham số <code>CV_LOAD_IMAGE_GRAYSCALE</code> trong hàm <code>imread</code>. Tham số <code>CV_LOAD_IMAGE_GRAYSCALE</code> thực chất là số <code>0</code> nên bạn có thực hiện lệnh <code> imread("img_sample.png", 0)</code> với chức năng tương tự.<br />
Nếu muốn giữ nguyên việc đọc ảnh đầu vào là ảnh màu, bạn có thể sử dụng một trong các lệnh sau<br />
<code>imread("img_sample.png")</code><br />
<code>imread("img_sample.png",1)</code><br />
<code>imread("img_sample.png",CV_LOAD_IMAGE_COLOR)</code><br />
với chức năng tương tự</p>
<p><strong>- Cách 2: Sử dụng lệnh cvtColor</strong></p>
<pre><code class="language-cpp">#include&lt;opencv2\opencv.hpp&gt;

using namespace cv;

int main(){
	Mat img = imread("img_sample.png", CV_LOAD_IMAGE_COLOR);
	Mat grayscale_img;
	cvtColor(img, grayscale_img, CV_BGR2GRAY);
	imshow("Sample", grayscale_img);
	waitKey(0);
	return 0;
}
</code></pre>
<p>Lệnh <code>cvtColor(source, dest, mode)</code> cho phép bạn chuyển đổi ảnh màu <code>source</code> sang ảnh xám và lưu vào <code>dest</code> với độ chuyển đổi màu là <code>mode</code>. <code>CV_BGR2GRAY</code> là chế độ cho phép chuyển từ ảnh màu lưu ở format BGR sang ảnh xám.</p>
<h4 id="2bininhentrngblackandwhiteconvert">2. Biến đổi ảnh đen trắng (Black-and-white convert)</h4>
<p><strong>What ?</strong><br />
Từ ảnh xám, bạn có thể biến đổi về thành ảnh chỉ có hai màu đen-trắng (black-and-white)<br />
<amp-img src="https://i.imgur.com/FlZlGsM.png" alt="img_3" width="900" height="600" layout="responsive"></amp-img></p>
<p><strong>Why ?</strong><br />
Ảnh đen trắng thường được ứng dụng trong bài toán phân vùng ảnh (Image segmentation). Giả sử trong hình ví dụ trên, bằng cách biến đổi ảnh về nhị phân, bạn có thể loại bỏ các thông khung cảnh xung quanh và chỉ giữ lại hai con cá heo trên hình.</p>
<p><strong>How ?</strong><br />
Ảnh đen trắng, như tên gọi, chỉ có hai màu đen với giá trị là <code>0</code> và trắng với giá trị <code>255</code>. Bài toán đặt ra là làm thế nào để biến đổi ảnh xám (hay nói cách khác là một ma trận 2 chiều với giá trị mỗi ô trong khoảng 0-255) về thành một ma trận 2 chiều với giá trị mỗi ô là 0 hoặc 255.<br />
Cách giải quyết là chọn một ngưỡng (threshold) để xác định đâu là điểm ảnh đen và đâu là điểm ảnh trắng. Nếu giá trị trên ảnh xám lớn hơn ngưỡng threshold, đấy là điểm ảnh trắng và ngược lại.<br />
<strong>Gọi ảnh xám là Gray, ảnh đen trắng cần xác định là BW, tọa độ các pixel trên hình là (x,y), ta có</strong><br />
<strong>- BW(x,y) = 255 nếu Gray(x,y) &gt; threshold</strong><br />
<strong>- BW(x,y) = 0 nếu Gray(x,y) &lt;= threshold</strong></p>
<p><strong>Implement</strong><br />
<strong>Sử dụng hàm <code>threshold</code></strong></p>
<pre><code class="language-cpp">#include&lt;opencv2\opencv.hpp&gt;

using namespace cv;

int main(){
	Mat img = imread("img_sample.png", CV_LOAD_IMAGE_GRAYSCALE);	
	Mat bw;
	threshold(img, bw, 150, 255, 0);
	imshow("Sample", bw);
	waitKey(0);
	return 0;
}
</code></pre>
<p>Lệnh <code>threshold(src, img, thres, max_value, type)</code> dùng để biến đổi ảnh xám <code>src</code> về thành ảnh đen trắng và lưu vào <code>dst</code>. Ngưỡng để xác định đen và trắng được truyền qua tham số <code>thres</code>. Ngoài ra, bạn có thể định nghĩa lại màu sáng nhất thông qua <code>max_value</code> (ngưỡng trắng). Hàm <code>threshold</code> hộ trợ một số loại biến đổi như sau:<br />
-<code>type = 0</code> <strong>Threshold Binary</strong> Biến đổi đen trắng giống định nghĩa phía trên<br />
-<code>type = 1</code> <strong>Threshold Binary, Inverted</strong> Biến đổi đen trắng ngược với định nghĩa trên<br />
-<code>type = 2</code> <strong>Truncate</strong> Nếu giá trị điểm ảnh lớn hơn <code>thres</code>, giá trị sẽ được đặt lại bằng <code>thres</code> (chặn mức sáng nhất)<br />
-<code>type = 3</code> <strong>Threshold to Zero</strong> Nếu giá trị điểm ảnh nhỏ hơn <code>thres</code>, điểm ảnh đó sẽ trở thành màu đen<br />
-<code>type = 4</code> <strong>Threshold to Zero, Inverted</strong> Ngược lại với <code>type = 3</code></p>
<p><amp-img src="https://i.imgur.com/nFc7MKO.png" alt="Imgur" width="1500" height="600" layout="responsive"></amp-img></p>
<p>Tùy vào ngưỡng threshold, chúng ta sẽ có kết quả hình khác nhau<br />
<amp-img src="https://i.imgur.com/RtdQb6M.png" alt="Imgur" width="1500" height="600" layout="responsive"></amp-img></p>
<p><strong>Sử dụng hàm <code>adaptiveThreshold</code></strong><br />
Như ở ví dụ trên, chúng ta có thể thấy kết quả phụ thuộc rất nhiều vào ngưỡng threshold. Trong thực tế, đối với các chương trình xử lý ảnh real-time, việc sử dụng một threshold cố định là điều không khả thi do cường độ sáng thay đổi liên tục. Để khắc phục tình trạng này, chúng ta có thể sử dụng hàm <code>adaptiveThreshold</code> do OpenCV hỗ trợ.</p>
<pre><code class="language-cpp">#include&lt;opencv2\opencv.hpp&gt;

using namespace cv;

int main(){
	Mat img = imread("img_sample.png", CV_LOAD_IMAGE_GRAYSCALE);	
	Mat bw;	
	adaptiveThreshold(img, bw, 255, ADAPTIVE_THRESH_GAUSSIAN_C, THRESH_BINARY, 11, 12);
	imshow("sample", bw);
	waitKey(0);
	return 0;
}
</code></pre>
<p>Hàm <code>adaptiveThreshold(src, dst, maxValue, adaptiveMethod, thresholdType, blockSize, C)</code> giúp biến đổi ảnh xám <code>src</code> về ảnh đen trắng <code>dst</code> với ngưỡng sáng tối đa <code>maxValue</code>. <code>adaptiveThreshold</code> hỗ trợ 2 phương pháp tự động chọn ngưỡng threshold là <code>ADAPTIVE_THRESH_MEAN_C </code> và <code>ADAPTIVE_THRESH_GAUSSIAN_C</code>; cùng với 2 chế độ <code>thresholdType</code> là <code>THRESH_BINARY</code> và <code>THRESH_BINARY_INV</code>. Các tham số <code>blockSize</code> và <code>C</code> dùng để chọn số lượng điểm lân cận để tính ngưỡng threshold tốt nhất.<br />
<amp-img src="https://i.imgur.com/lyRa2Cw.jpg" alt="Imgur" width="339" height="600" layout="responsive"></amp-img></p>
<h3 id="tngkt">Tổng kết</h3>
<p>Bài viết vừa đề cập đến hai kĩ thuật chuyển đổi ảnh cực kỳ phổ biến trong xử lý ảnh là biến đổi ảnh xám (Grayscale convert) và biến đổi ảnh nhị phân (Black-and-white convert). Hi vọng các bạn đã hiểu rõ về các phương pháp mình vừa trình bày trên.<br />
Hẹn gặp lại các bạn trong bài kế tiếp - các phương pháp lọc ảnh.</p>
<p>HMD.</p>


            </section>

        </article>
    </main>
    <footer class="page-footer">
        <h3>GMO-Z.com Vietnam Lab Center Technology Blog</h3>
            <p>Blog chia sẻ kỹ thuật của thành viên công ty GMO-Z.com Vietnam Lab Center</p>
        <p><a href="../../index.html">Read more posts →</a></p>
        <a class="powered" href="https://ghost.org" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 156 156"><g fill="none" fill-rule="evenodd"><rect fill="#15212B" width="156" height="156" rx="27"/><g transform="translate(36 36)" fill="#F6F8FA"><path d="M0 71.007A4.004 4.004 0 014 67h26a4 4 0 014 4.007v8.986A4.004 4.004 0 0130 84H4a4 4 0 01-4-4.007v-8.986zM50 71.007A4.004 4.004 0 0154 67h26a4 4 0 014 4.007v8.986A4.004 4.004 0 0180 84H54a4 4 0 01-4-4.007v-8.986z"/><rect y="34" width="84" height="17" rx="4"/><path d="M0 4.007A4.007 4.007 0 014.007 0h41.986A4.003 4.003 0 0150 4.007v8.986A4.007 4.007 0 0145.993 17H4.007A4.003 4.003 0 010 12.993V4.007z"/><rect x="67" width="17" height="17" rx="4"/></g></g></svg> Published with Ghost</a>
    </footer>
    
</body>
</html>
