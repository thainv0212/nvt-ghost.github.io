<!DOCTYPE html>
<html ⚡>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">

    <title>[Nhập môn Kubernetes P2] - Các môi trường Kubernetes</title>

    <link rel="canonical" href="../index.html" />
    <meta name="referrer" content="no-referrer-when-downgrade" />
    
    <meta property="og:site_name" content="GMO-Z.com Vietnam Lab Center Technology Blog" />
    <meta property="og:type" content="article" />
    <meta property="og:title" content="[Nhập môn Kubernetes P2] - Các môi trường Kubernetes" />
    <meta property="og:description" content="Serial blog Nhập môn Kubernetes  Nội dung Các môi trường Kubernetes Local Kubermetes Công cụ hỗ trợ thiết lập môi trường Kubernetes Quản lý Kubernetes trên public cloud Kết luận Mở đầu Trong phần 1 của loạt bài viết về k8s, mình đã trình bày tại sao k8s là cần" />
    <meta property="og:url" content="https://blog.vietnamlab.vn/nhap-mon-kubernetes-p2-chon-moi-truong-kubernetes/" />
    <meta property="og:image" content="https://drive.google.com/uc?id&#x3D;1dpYJg5gQ0pjoXpC9Yr2q_mmXPPoRb-vx&amp;export&#x3D;download" />
    <meta property="article:published_time" content="2018-09-04T01:26:50.000Z" />
    <meta property="article:modified_time" content="2018-09-25T02:32:41.000Z" />
    <meta property="article:tag" content="kubernetes" />
    <meta property="article:tag" content="docker" />
    <meta property="article:tag" content="k8s" />
    <meta property="article:tag" content="Container orchestration" />
    <meta property="article:tag" content="minikube" />
    <meta property="article:tag" content="EKS" />
    <meta property="article:tag" content="Elastic Container Service for Kubernetes" />
    <meta property="article:tag" content="GKE" />
    <meta property="article:tag" content="Google Kubernetes Engine" />
    
    <meta property="article:publisher" content="https://www.facebook.com/vietnamlab.vn" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="[Nhập môn Kubernetes P2] - Các môi trường Kubernetes" />
    <meta name="twitter:description" content="Serial blog Nhập môn Kubernetes  Nội dung Các môi trường Kubernetes Local Kubermetes Công cụ hỗ trợ thiết lập môi trường Kubernetes Quản lý Kubernetes trên public cloud Kết luận Mở đầu Trong phần 1 của loạt bài viết về k8s, mình đã trình bày tại sao k8s là cần" />
    <meta name="twitter:url" content="https://blog.vietnamlab.vn/nhap-mon-kubernetes-p2-chon-moi-truong-kubernetes/" />
    <meta name="twitter:image" content="https://drive.google.com/uc?id&#x3D;1dpYJg5gQ0pjoXpC9Yr2q_mmXPPoRb-vx&amp;export&#x3D;download" />
    <meta name="twitter:label1" content="Written by" />
    <meta name="twitter:data1" content="N.X.P" />
    <meta name="twitter:label2" content="Filed under" />
    <meta name="twitter:data2" content="kubernetes, docker, k8s, Container orchestration, minikube, EKS, Elastic Container Service for Kubernetes, GKE, Google Kubernetes Engine" />
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "GMO-Z.com Vietnam Lab Center Technology Blog",
        "url": "https://blog.vietnamlab.vn/",
        "logo": {
            "@type": "ImageObject",
            "url": "https://blog.vietnamlab.vn/favicon.ico",
            "width": 48,
            "height": 48
        }
    },
    "author": {
        "@type": "Person",
        "name": "N.X.P",
        "image": {
            "@type": "ImageObject",
            "url": "https://drive.google.com/uc?id=1ey3d-hkzyw7sUxoxSNSNVlTPDeoVuhCq&export=download",
            "width": 1738,
            "height": 1412
        },
        "url": "https://blog.vietnamlab.vn/author/phongnx/",
        "sameAs": []
    },
    "headline": "[Nhập môn Kubernetes P2] - Các môi trường Kubernetes",
    "url": "https://blog.vietnamlab.vn/nhap-mon-kubernetes-p2-chon-moi-truong-kubernetes/",
    "datePublished": "2018-09-04T01:26:50.000Z",
    "dateModified": "2018-09-25T02:32:41.000Z",
    "image": {
        "@type": "ImageObject",
        "url": "https://drive.google.com/uc?id=1dpYJg5gQ0pjoXpC9Yr2q_mmXPPoRb-vx&export=download"
    },
    "keywords": "kubernetes, docker, k8s, Container orchestration, minikube, EKS, Elastic Container Service for Kubernetes, GKE, Google Kubernetes Engine",
    "description": "Serial blog Nhập môn Kubernetes\n[https://blog.vietnamlab.vn/2018/09/25/nhap-mon-kubernetes-gioi-thieu-rerial-kubernetes/]\n\nNội dung\n * Các môi trường Kubernetes\n * Local Kubermetes\n * Công cụ hỗ trợ thiết lập môi trường Kubernetes\n * Quản lý Kubernetes trên public cloud\n * Kết luận\n\nMở đầu\nTrong phần 1 của loạt bài viết về k8s, mình đã trình bày tại sao k8s là cần\nthiết. Mọi người có thể tham khảo [Nhập môn Kubernetes P1] - Tại sao Kubernetes\nlà cần thiết? [https://blog.vietnamlab.vn/2018/08/08/",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://blog.vietnamlab.vn/"
    }
}
    </script>

    <meta name="generator" content="Ghost 3.36" />
    <link rel="alternate" type="application/rss+xml" title="GMO-Z.com Vietnam Lab Center Technology Blog" href="../../rss/index.html" />

    <style amp-custom>
    *,
    *::before,
    *::after {
        box-sizing: border-box;
    }

    html {
        overflow-x: hidden;
        overflow-y: scroll;
        font-size: 62.5%;
        -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
    }

    body {
        min-height: 100vh;
        margin: 0;
        padding: 0;
        color: #3a4145;
        font-family: -apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Open Sans,Helvetica Neue,sans-serif;
        font-size: 1.7rem;
        line-height: 1.55em;
        font-weight: 400;
        font-style: normal;
        background: #fff;
        scroll-behavior: smooth;
        overflow-x: hidden;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
    }

    p,
    ul,
    ol,
    li,
    dl,
    dd,
    hr,
    pre,
    form,
    table,
    video,
    figure,
    figcaption,
    blockquote {
        margin: 0;
        padding: 0;
    }

    ul[class],
    ol[class] {
        padding: 0;
        list-style: none;
    }

    img {
        display: block;
        max-width: 100%;
    }

    input,
    button,
    select,
    textarea {
        font: inherit;
        -webkit-appearance: none;
    }

    fieldset {
        margin: 0;
        padding: 0;
        border: 0;
    }

    label {
        display: block;
        font-size: 0.9em;
        font-weight: 700;
    }

    hr {
        position: relative;
        display: block;
        width: 100%;
        height: 1px;
        border: 0;
        border-top: 1px solid currentcolor;
        opacity: 0.1;
    }

    ::selection {
        text-shadow: none;
        background: #cbeafb;
    }

    mark {
        background-color: #fdffb6;
    }

    small {
        font-size: 80%;
    }

    sub,
    sup {
        position: relative;
        font-size: 75%;
        line-height: 0;
        vertical-align: baseline;
    }
    sup {
        top: -0.5em;
    }
    sub {
        bottom: -0.25em;
    }

    ul li + li {
        margin-top: 0.6em;
    }

    a {
        color: #1292EE;
        text-decoration-skip-ink: auto;
    }

    h1,
    h2,
    h3,
    h4,
    h5,
    h6 {
        margin: 0;
        font-weight: 700;
        color: #121212;
        line-height: 1.4em;
    }

    h1 {
        font-size: 3.4rem;
        line-height: 1.1em;
    }

    h2 {
        font-size: 2.4rem;
        line-height: 1.2em;
    }

    h3 {
        font-size: 1.8rem;
    }

    h4 {
        font-size: 1.7rem;
    }

    h5 {
        font-size: 1.6rem;
    }

    h6 {
        font-size: 1.6rem;
    }

    amp-img {
        height: 100%;
        width: 100%;
        max-width: 100%;
        max-height: 100%;
    }

    amp-img img {
        object-fit: cover;
    }

    .page-header {
        padding: 50px 5vmin 30px;
        text-align: center;
        font-size: 2rem;
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }

    .page-header a {
        color: #121212;
        font-weight: 700;
        text-decoration: none;
        font-size: 1.6rem;
        letter-spacing: -0.1px;
    }

    .post {
        max-width: 680px;
        margin: 0 auto;
    }

    .post-header {
        margin: 0 5vmin 5vmin;
        text-align: center;
    }

    .post-meta {
        margin: 1rem 0 0 0;
        text-transform: uppercase;
        color: #738a94;
        font-weight: 500;
        font-size: 1.3rem;
    }

    .post-image {
        margin: 0 0 5vmin;
    }

    .post-image img {
        display: block;
        width: 100%;
        height: auto;
    }

    .post-content {
        padding: 0 5vmin;
    }

    .post-content > * + * {
        margin-top: 1.5em;
    }

    .post-content [id]:not(:first-child) {
        margin: 2em 0 0;
    }

    .post-content > [id] + * {
        margin-top: 1rem;
    }

    .post-content [id] + .kg-card,
    .post-content blockquote + .kg-card {
        margin-top: 40px;
    }

    .post-content > ul,
    .post-content > ol,
    .post-content > dl {
        padding-left: 1.9em;
    }

    .post-content hr {
        margin-top: 40px;
    }

    .post .post-content hr + * {
        margin-top: 40px;
    }

    .post-content amp-img {
        background-color: #f8f8f8;
    }

    .post-content blockquote {
        position: relative;
        font-style: italic;
    }

    .post-content blockquote::before {
        content: "";
        position: absolute;
        left: -1.5em;
        top: 0;
        bottom: 0;
        width: 0.3rem;
        background: #000;
    }

    .post-content :not(.kg-card):not([id]) + .kg-card {
        margin-top: 40px;
    }

    .post-content .kg-card + :not(.kg-card) {
        margin-top: 40px;
    }

    .kg-card figcaption {
        padding: 1.5rem 1.5rem 0;
        text-align: center;
        font-weight: 500;
        font-size: 1.3rem;
        line-height: 1.4em;
        opacity: 0.6;
    }

    .kg-card figcaption strong {
        color: rgba(0,0,0,0.8);
    }

    .post-content :not(pre) code {
        vertical-align: middle;
        padding: 0.15em 0.4em 0.15em;
        border: #e1eaef 1px solid;
        font-weight: 400;
        font-size: 0.9em;
        line-height: 1em;
        color: #dc0050;
        background: #f0f6f9;
        border-radius: 0.25em;
    }

    .post-content > pre {
        overflow: scroll;
        padding: 16px 20px;
        color: #fff;
        background: #1F2428;
        border-radius: 5px;
        box-shadow: 0 2px 6px -2px rgba(0,0,0,.1), 0 0 1px rgba(0,0,0,.4);
    }

    .kg-embed-card {
        display: flex;
        flex-direction: column;
        align-items: center;
        width: 100%;
    }

    .kg-image-card img {
        margin: auto;
    }

    .kg-gallery-card + .kg-gallery-card {
        margin-top: 0.75em;
    }

    .kg-gallery-container {
        position: relative;
    }

    .kg-gallery-row {
        display: flex;
        flex-direction: row;
        justify-content: center;
    }

    .kg-gallery-image {
        width: 100%;
        height: 100%;
    }

    .kg-gallery-row:not(:first-of-type) {
        margin: 0.75em 0 0 0;
    }

    .kg-gallery-image:not(:first-of-type) {
        margin: 0 0 0 0.75em;
    }

    .kg-bookmark-card,
    .kg-bookmark-publisher {
        position: relative;
    }

    .kg-bookmark-container,
    .kg-bookmark-container:hover {
        display: flex;
        flex-wrap: wrap;
        flex-direction: row-reverse;
        color: currentColor;
        background: rgba(255,255,255,0.6);
        font-family: -apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Open Sans,Helvetica Neue,sans-serif;
        text-decoration: none;
        border-radius: 5px;
        box-shadow: 0 2px 6px -2px rgba(0, 0, 0, 0.1), 0 0 1px rgba(0, 0, 0, 0.4);
        overflow: hidden;
    }

    .kg-bookmark-content {
        flex-basis: 0;
        flex-grow: 999;
        padding: 20px;
        order: 1;
    }

    .kg-bookmark-title {
        font-weight: 600;
        font-size: 1.5rem;
        line-height: 1.3em;
    }

    .kg-bookmark-description {
        display: -webkit-box;
        max-height: 45px;
        margin: 0.5em 0 0 0;
        font-size: 1.4rem;
        line-height: 1.55em;
        overflow: hidden;
        opacity: 0.8;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
    }

    .kg-bookmark-metadata {
        margin-top: 20px;
    }

    .kg-bookmark-metadata {
        display: flex;
        align-items: center;
        font-weight: 500;
        font-size: 1.3rem;
        line-height: 1.3em;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }

    .kg-bookmark-description {
        display: -webkit-box;
        -webkit-box-orient: vertical;
        -webkit-line-clamp: 2;
        overflow: hidden;
    }

    .kg-bookmark-metadata amp-img {
        width: 18px;
        height: 18px;
        max-width: 18px;
        max-height: 18px;
        margin-right: 10px;
    }

    .kg-bookmark-thumbnail {
        display: flex;
        flex-basis: 20rem;
        flex-grow: 1;
        justify-content: flex-end;
    }

    .kg-bookmark-thumbnail amp-img {
        max-height: 200px;
    }

    .kg-bookmark-author {
        white-space: nowrap;
        text-overflow: ellipsis;
        overflow: hidden;
    }

    .kg-bookmark-publisher::before {
        content: "•";
        margin: 0 .5em;
    }

    .kg-width-full.kg-card-hascaption {
        display: grid;
        grid-template-columns: inherit;
    }

    .post-content table {
        border-collapse: collapse;
        width: 100%;
    }

    .post-content th {
        padding: 0.5em 0.8em;
        text-align: left;
        font-size: .75em;
        text-transform: uppercase;
    }

    .post-content td {
        padding: 0.4em 0.7em;
    }

    .post-content tbody tr:nth-child(2n + 1) {
        background-color: rgba(0,0,0,0.1);
        padding: 1px;
    }

    .post-content tbody tr:nth-child(2n + 2) td:last-child {
        box-shadow:
            inset 1px 0 rgba(0,0,0,0.1),
            inset -1px 0 rgba(0,0,0,0.1);
    }

    .post-content tbody tr:nth-child(2n + 2) td {
        box-shadow: inset 1px 0 rgba(0,0,0,0.1);
    }

    .post-content tbody tr:last-child {
        border-bottom: 1px solid rgba(0,0,0,.1);
    }

    .page-footer {
        padding: 60px 5vmin;
        margin: 60px auto 0;
        text-align: center;
        background-color: #f8f8f8;
    }

    .page-footer h3 {
        margin: 0.5rem 0 0 0;
    }

    .page-footer p {
        max-width: 500px;
        margin: 1rem auto 1.5rem;
        font-size: 1.7rem;
        line-height: 1.5em;
        color: rgba(0,0,0,0.6)
    }

    .powered {
        display: inline-flex;
        align-items: center;
        margin: 30px 0 0;
        padding: 6px 9px 6px 6px;
        border: rgba(0,0,0,0.1) 1px solid;
        font-size: 12px;
        line-height: 12px;
        letter-spacing: -0.2px;
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Roboto", "Oxygen", "Ubuntu", "Cantarell", "Fira Sans", "Droid Sans", "Helvetica Neue", sans-serif;
        font-weight: 500;
        color: #222;
        text-decoration: none;
        background: #fff;
        border-radius: 6px;
    }

    .powered svg {
        height: 16px;
        width: 16px;
        margin: 0 6px 0 0;
    }

    @media (max-width: 600px) {
        body {
            font-size: 1.6rem;
        }
        h1 {
            font-size: 3rem;
        }

        h2 {
            font-size: 2.2rem;
        }
    }

    @media (max-width: 400px) {
        h1 {
            font-size: 2.6rem;
            line-height: 1.15em;
        }
        h2 {
            font-size: 2rem;
            line-height: 1.2em;
        }
        h3 {
            font-size: 1.7rem;
        }
    }
    </style>

    <style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style><noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript>
    <script async src="https://cdn.ampproject.org/v0.js"></script>

    

</head>

<body class="amp-template">
    <header class="page-header">
        <a href="../../index.html">
                GMO-Z.com Vietnam Lab Center Technology Blog
        </a>
    </header>

    <main class="content" role="main">
        <article class="post">

            <header class="post-header">
                <h1 class="post-title">[Nhập môn Kubernetes P2] - Các môi trường Kubernetes</h1>
                <section class="post-meta">
                    N.X.P -
                    <time class="post-date" datetime="2018-09-04">04 Sep 2018</time>
                </section>
            </header>
            <figure class="post-image">
                <amp-img src="https://drive.google.com/uc?id&#x3D;1dpYJg5gQ0pjoXpC9Yr2q_mmXPPoRb-vx&amp;export&#x3D;download" width="600" height="340" layout="responsive"></amp-img>
            </figure>
            <section class="post-content">

                <p><a href="https://blog.vietnamlab.vn/2018/09/25/nhap-mon-kubernetes-gioi-thieu-rerial-kubernetes/">Serial blog Nhập môn Kubernetes</a></p>
<h3 id="nidung">Nội dung</h3>
<ul>
<li>Các môi trường Kubernetes</li>
<li>Local Kubermetes</li>
<li>Công cụ hỗ trợ thiết lập môi trường Kubernetes</li>
<li>Quản lý Kubernetes trên public cloud</li>
<li>Kết luận</li>
</ul>
<h3 id="mu">Mở đầu</h3>
<p>Trong phần 1 của loạt bài viết về k8s, mình đã trình bày tại sao k8s là cần thiết. Mọi người có thể tham khảo <a href="https://blog.vietnamlab.vn/2018/08/08/nhap-mon-kubernetes/">[Nhập môn Kubernetes P1] - Tại sao Kubernetes là cần thiết?</a><br />
Tiếp tục series bài viết về K8s, trong phần 2 này mình sẽ nói về việc chuẩn bị môi trường kubernetes.</p>
<h3 id="ccmitrngkubernetes">Các môi trường Kubernetes</h3>
<p>Trường hợp sử dụng môi trường k8s, nếu phân loại thì mình cho rằng có 3 loại lớn như sau:</p>
<ul>
<li>Chạy k8s trên môi trường local Windows/MAC</li>
<li>Sử dụng công cụ thiết lập k8s, xây dựng Cluster</li>
<li>Sử dụng Public Cloud Managed Kubernetes</li>
</ul>
<p>Tuỳ theo từng môi trường, cũng có những phần không thiết lập được như là liên kết với load bancing bên ngoài, Dynamic Persistent Volume vv. Tuy nhiên, về cơ bản cho dù là môi trường nào đi nữa, để có thể hoạt động giống nhau CNCF đã dung cấp Conformance Program. Trong các môi trường k8s mà mình giới thiệu lần này đều là Certified Kubernetes Distribution/Platform được thiết lập bởi Conformance Program. Có nhiều sự lựa chọn, tuy nhiên lần này trong mỗi phương pháp mình sẽ chỉ giới thiệu 2,3 loại cho mỗi phương pháp.</p>
<ul>
<li>Local Kubernetes
<ul>
<li>Minikube</li>
<li>Docker for Mac</li>
</ul>
</li>
<li>Tool kiến trúc Kubernetes
<ul>
<li>Kubeadm</li>
<li>Rancher</li>
</ul>
</li>
<li>Public Cloud Managed Kubernetes
<ul>
<li>Google Kubernetes Engine（GKE）</li>
<li>Azure Container Service（AKS）</li>
<li>Elastic Container Service for Kubernetes（EKS）</li>
</ul>
</li>
</ul>
<h3 id="localkubernetes">Local Kubernetes</h3>
<p>Đối với môi trường local k8s, là một phương pháp để bạn có thể thử k8s một cách tự do trên máy tính của bạn. Để hoạt động trên cấu hình tất cả trong một máy thì tính dự phòng sẽ không được đảm bảo, bạn cần chú ý điểm này. Thêm vào đó, một số chức năng sẽ không sử dụng được.</p>
<h4 id="minikube">Minikube</h4>
<p><amp-img src="https://drive.google.com/uc?id=13ZFOi3gEfCiP8mCy3gQ03mEkXQnpPkGI&amp;export=download" alt="uc?id=13ZFOi3gEfCiP8mCy3gQ03mEkXQnpPkGI&amp;export=download" width="400" height="388" layout="responsive"></amp-img><br />
<em>Logo minikube</em></p>
<p>Để vận hành k8s một cách đơn giản, trong tầm kiểm soát, hầu hết mọi người sẽ chọn Minikube. Vì Các thao tác trong Minikube yêu cầu VirtualBox mặc định, nên chúng ta cần cài đặt trước. Đặc biệt khi bạn không quan tâm đến version đặc biệt nào thì bằng package manager như Homebrew bạn cũng có thể cài đặt được. Bạn có thể cài đặt bằng cách khác, ngoài ra bạn cũng có thể sử dụng  xhyve hay VMware Fusion.</p>
<p><strong>Lưu ý:</strong> Các cài đặt dưới đây mình chạy trên máy MAC. Các bạn có thể tìm hiểu và cài trên môi trường Linux chẳng hạn.<br />
<strong>Linux:</strong> <a href="https://kubernetes.io/docs/tasks/tools/install-minikube/">https://kubernetes.io/docs/tasks/tools/install-minikube/</a></p>
<p>Đầu tiên tải và cài đặt VirtualBox:<br />
<a href="https://www.virtualbox.org/wiki/Downloads">https://www.virtualbox.org/wiki/Downloads</a></p>
<pre><code>$ brew update
$ brew install kubectl
$ brew cask install virtualbox 
</code></pre>
<p>Cài đặt minikube bằng brew command hoặc download binary.<br />
<strong>Cài minikube bằng brew command</strong></p>
<pre><code>$ brew cask install minikube
</code></pre>
<p><strong>Cài minikube bằng cách download binary</strong></p>
<pre><code>$ curl -Lo minikube https://storage.googleapis.com/minikube/releases/latest/minikube-darwin-amd64
$ chmod 755 minikube
</code></pre>
<p>Sau khi đã chuẩn bị sẵn sàng, chúng ta khởi động Minikube. Trong trường hợp chỉ định version cụ thể thì hãy chỉ định option --kubernetes-version.</p>
<pre><code>$ minikube start
Starting local Kubernetes v1.10.0 cluster...
Starting VM...
Downloading Minikube ISO
 160.27 MB / 160.27 MB [============================================] 100.00% 0s
Getting VM IP address...
Moving files into cluster...
Downloading kubeadm v1.10.0
Downloading kubelet v1.10.0
Finished Downloading kubeadm v1.10.0
Finished Downloading kubelet v1.10.0
Setting up certs...
Connecting to cluster...
Setting up kubeconfig...
Starting cluster components...
Kubectl is now configured to use the cluster.
Loading cached images from config file.
</code></pre>
<p>Để xác nhận Minikube hoạt động chính xác hay không chúng ta gõ command minikube status, Nếu trạng thái của Minikube như dưới đây là OK. Lúc này thì VM dùng cho Minikube đã được khởi động trên VirtualBox. Từ đây về sau thì chúng ta có thể thao tác trên Cluster của Minikube bằng kubectl.</p>
<pre><code>$ minikube status
minikube: Running
cluster: Running
kubectl: Correctly Configured: pointing to minikube-vm at 192.168.99.100
</code></pre>
<p>Tiếp theo chúng ta test thử hoạt động của minikube thế nào nhé. Chạy command sau để tạo 1 pod với container được build từ image centos:7, khi pod được tạo ra thì đồng thời truy cập vào terminal của container centos.</p>
<pre><code>$ kubectl run -i --tty --image=centos:7 testpod  --rm /bin/sh
If you don't see a command prompt, try pressing enter.
sh-4.2# 
</code></pre>
<p>Để kiểm tra các pod đang hoạt động, mở một Terminal khác trên MAC, gõ command sau:</p>
<pre><code>$ kubectl get pods
NAME                      READY     STATUS    RESTARTS   AGE
testpod-9949f7bdc-nctwb   1/1       Running   0          3s
$ 
</code></pre>
<p>Chúng ta có 1 pod đang hoạt động.</p>
<p>Nếu bạn không cần thiết nữa thì có thể xoá dễ dàng như sau:</p>
<pre><code>minikube delete
</code></pre>
<h4 id="dockerformac">Docker for Mac</h4>
<p>Tại sự kiện DockerCon EU 17, công ty Docker cũng đã phát biểu về Kubermetes support, thao tác với Docker Swarm từ CLI của Kubernetes, các chức năng liên kết được đã được cường hoá. Ở Docker for Mac cũng vậy, từ vesion 17.12 CE Edge chúng ta có thể khởi động Kubernetes trên máy local, đó cũng là một sự lựa chọn. Tuy nhiên không thể chỉ định vesion cụ thể, các bạn nên chú ý.</p>
<p><strong>Các bước cài đặt Docker for Mac:</strong><br />
<a href="https://docs.docker.com/docker-for-mac/install/">Install Docker for Mac</a><br />
Để sử dụng Kubernetes bằng Docker for Mac, sau khi khởi động Docker, Từ Preference chúng ta chọn Enable Kubernetes.<br />
<amp-img src="https://drive.google.com/uc?id=1CEvhkAA_DyJgPzOBEb45RKoWorQc9WXT&amp;export=download" alt="uc?id=1CEvhkAA_DyJgPzOBEb45RKoWorQc9WXT&amp;export=download" width="801" height="327" layout="responsive"></amp-img><br />
Việc tích hợp Kubernetes mất tầm 5phút<br />
<amp-img src="https://drive.google.com/uc?id=1LZ3GqqMUJAPBLkCmsIi8x1WI3PF9SGf-&amp;export=download" alt="uc?id=1LZ3GqqMUJAPBLkCmsIi8x1WI3PF9SGf-&amp;export=download" width="1004" height="654" layout="responsive"></amp-img></p>
<p>Trường hợp bạn đang sử dụng Minikube, context sẽ bị lẫn lộn giữa minikube với việc tích hợp k8s cho Docker for Mac, nên mình khuyên là nên thực hiện chuyển đổi, sau đó thì thoải mái thao tác trên Cluster với kubectl.</p>
<pre><code>kubectl config use-context docker-for-desktop
</code></pre>
<p>Trên kubectl, Docker hosts được xem như một nodes.</p>
<pre><code>$ kubectl get nodes
NAME                 STATUS    ROLES     AGE       VERSION
docker-for-desktop   Ready     master    12m       v1.10.2
</code></pre>
<h3 id="cngckintrckubernetes">Công cụ kiến trúc Kubernetes</h3>
<p>Tiếp sau đây mình sẽ giới thiệu đến các bạn phương pháp sử dụng công cụ cấu trúc để cài đặt môi trường kubernetes trên máy tính. Trong cả 2 cách dưới đây, đều có thể xây dựng kubernetes cluster có nhiều nodes.</p>
<h4 id="kubeadm">kubeadm</h4>
<p>kubeadm là một công cụ cấu trúc được cung cấp chính thức bởi Kubernetes. Cũng có version mà một bộ phận nào đó không hoạt động được, tuy nhiên về cơ bản thì nó vẫn được đánh giá cao.<br />
<a href="https://kubernetes.io/docs/setup/independent/install-kubeadm/">https://kubernetes.io/docs/setup/independent/install-kubeadm/</a></p>
<h4 id="rancher">Rancher</h4>
<p>Rancher là một open source được phát triển chủ yếu bới công ty Rancher Labs. Trong phiên bản 1.0 nó được thiết kế để hỗ trợ Kubernetes, nhưng từ phiên bản 2.0 trở đi thì nó phát triển Kubernetes như là một nhiệm vụ chính.<br />
Những đặc trưng của Rancher 2.0 theo mình thì như sau:</p>
<ul>
<li>Có thể triển khai Kubernetes Cluster trên nhiều platform như AWS, OpenStack, VMware v.v.</li>
<li>Kubernetes cluster hiện tại có thể được quản lý bởi Rancher</li>
<li>Cung cấp chức năng xác thực tập trung, monitoring, hay là WebUI.</li>
<li>application catalog phong phú.</li>
</ul>
<p>Bản thân Rancher, nó có thể được sử dụng như một máy chủ tập trung bằng cách khởi động Rancher rerver.</p>
<pre><code>#Khởi động Rancher Server
docker run -d --restart=unless-stopped -p 8080:8080 rancher/server:v2.0.0-alpha10
</code></pre>
<p>Từ Rancher server này chúng ta có thể thực hiện quản lý Kubernetes cluster, liên kết với các nhà cung cấp dịch vụ cloud vv. Trường hợp bạn sử dụng trên môi trường production hãy tính đến khả năng có thể sử dụng Database backup bên ngoài, cấu hình cho Rancher server vv.<br />
<amp-img src="https://drive.google.com/uc?id=1dFDZTYbXEOx65ueiu0T6R6JiJ2Bb3hvD&amp;export=download" alt="uc?id=1dFDZTYbXEOx65ueiu0T6R6JiJ2Bb3hvD&amp;export=download" width="1412" height="575" layout="responsive"></amp-img><br />
<em>Giao diện Rancher 2.0</em></p>
<h4 id="mtstoolkhc">Một số tool khác</h4>
<p>Còn một số công cụ cấu trúc Kubernetes mà mình chưa giới thiệu trong bài viết này, nếu đề cử ra một vài cái tên nổi tiếng như là:</p>
<ul>
<li>Techtonic được phát triển bởi công ty CoreOS</li>
<li>Kubespray sử dụng Ansible</li>
<li><a href="https://labs.septeni-technology.jp/continuous-integration/terraform-mot-cong-cu-de-lam-infrastructure-as-code/">Terraform</a></li>
<li>Kops có khả năng xuất tập có định dạng CloudFormation.</li>
<li>OpenStack Magnum sử dụng OpenStack Heat.</li>
</ul>
<h3 id="managedkubernetesonpubliccloud">Managed Kubernetes on public cloud</h3>
<p>Phương pháp thứ 3 mình muốn giới thiệu đó là Managed Kubernetes. Với Kubernetes trên public cloud, chúng ta có thể thực hiện việc tích hợp một cách đơn giản các tính năng như Liên kết với Persistent volume, Liên kết với load balancing vv.</p>
<h4 id="gkegooglekubernetesengine">GKE（Google Kubernetes Engine）</h4>
<p><amp-img src="https://drive.google.com/uc?id=1EAWp1lKET-KBy42qS4-xLOwpttfJix1v&amp;export=download" alt="uc?id=1EAWp1lKET-KBy42qS4-xLOwpttfJix1v&amp;export=download" width="300" height="300" layout="responsive"></amp-img></p>
<p>Với GKE chúng ta có thể sử dụng được nhiều chức năng tiện lợi mà GKE cung cấp. Ví dụ như chúng ta có thể thực hiện version up cluster một cách đơn giản vì GKE đã chuẩn bị sẵn các cơ chế như là tự động phục hồi, tự động update. Ngoài ra vì chúng ta có thể cấu trúc cluster mà đã sử dụng các nodes ưu tiên của GCE（Google Compute Engine）nên chi phí xây dựng giảm đáng kể. Vì sử dụng container nên chúng ta có khả năng thiết kế để cho cho dù một node kubernetes tái khởi tạo lại đi nữa, thì cũng không ảnh hưởng đến service.<br />
GKE có thể thực hiện tích hợp với chức năng của GCP (Google Cloud Platform). Chẳng hạn như liên kết với Stackdriver Logging, mặc định nó sẽ thu thập tất cả các log xuất ra bởi container. GKE còn có một điểm mạnh nữa là có thể sử dụng LoadBalancer（Ingress）với hiệu xuất cao.<br />
Một khái niệm cũng rất quan trọng trong GKE đó là chức năng NodePool. NodePool là một chức năng grouping bằng cách gán nhãn cho từng node trong Kubernetes cluster. Ví dụ như chúng ta có khả năng triển khai hỗn tạp nhiều node khác nhau kiểu như [Node có số lượng CPU nhiều], [Node có Memnory nhiều] trên cùng một cluster, điều đó cho phép chúng ta tính toán để thực hiện lúc Container scheduling sao cho hợp lý. Thêm nữa, trong trường hợp chúng ta không chỉ định cụ thể khi scheduling, nó sẽ tự động triển khai trên một node bất kỳ. Bằng cách nhóm các nodes khác vào group, cũng có thể phòng trừ được sự hỗn loạn của workload.<br />
<amp-img src="https://drive.google.com/uc?id=13HpPb3sLEbygK78TPjZTTJ4TQDIosxB5&amp;export=download" alt="uc?id=13HpPb3sLEbygK78TPjZTTJ4TQDIosxB5&amp;export=download" width="745" height="564" layout="responsive"></amp-img><br />
Khi cấu trúc kubernetes bằng GKE, có thể cấu trúc bằng GUI hoặc sử dụng gcloud command.</p>
<pre><code>$ gcloud container clusters create example-cluster
</code></pre>
<p>Thông tin xác thực đến kubernetes sau khi bạn cấu trúc xong được lưu trong thư mục ~/.kube/config</p>
<pre><code>$ gcloud container clusters get-credentials example-cluster
</code></pre>
<p>Thông tin chi tiết các bạn tham khảo link bên dưới:<br />
<a href="https://cloud.google.com/kubernetes-engine/">Google Kubernetes Engine</a><br />
Bản tiếng việt:<br />
<a href="http://vn.apps-gcp.com/google-kubernetes-engine/">http://vn.apps-gcp.com/google-kubernetes-engine/</a>.</p>
<p>Hiện tại thì các bạn có thẻ Visa có thể đăng ký sử dụng Google Cloud Platform. Google sẽ tặng bạn miễn phí 300$ sử dụng trong vòng 1 năm để thoả thích tạo máy ảo, IP, và tất nhiên là có cả Kubernetes Cluster nữa. Các bạn thử dùng nhé, tạo Cluster và chạy các demo nhanh cực.</p>
<p>Tham khảo:<br />
<a href="https://viblo.asia/p/voc-vps-voi-300-mien-phi-tu-google-V3m5Wz1ylO7">https://viblo.asia/p/voc-vps-voi-300-mien-phi-tu-google-V3m5Wz1ylO7</a></p>
<p>Các bạn vào mục Kubernetes Engine -&gt; Cluster<br />
<amp-img src="https://drive.google.com/uc?id=1aMTbxh0ElM1A4lQObXDw3HEIAU1fJpds&amp;export=download" alt="uc?id=1aMTbxh0ElM1A4lQObXDw3HEIAU1fJpds&amp;export=download" width="1298" height="483" layout="responsive"></amp-img></p>
<p>Chọn Connect để lấy thông tin kết nối và chạy nó ở máy local của bạn, khi đó các thao tác ở terminal ở local cũng như thao tác trên cluster. Tất nhiên khi không dùng nữa thì các bạn delete đi nhé, dựa vào price plan mà tính toán tạo bao nhiêu Nodes, dùng bao lâu, chứ không là đi 300$ nhanh lắm. :D</p>
<h4 id="aksazurecontainerservice">AKS（Azure Container Service）</h4>
<p><amp-img src="https://drive.google.com/uc?id=1-kIzA1LBx2G35eCMytiW7bjg7mskP5Qf&amp;export=download" alt="uc?id=1-kIzA1LBx2G35eCMytiW7bjg7mskP5Qf&amp;export=download" width="270" height="130" layout="fixed"></amp-img><br />
AKS cũng là một Managed Kubernetes có thể sử dụng cho việc update Kubernetes một cách tự động.<br />
Chi tiết các bạn tham khảo link dưới đây:<br />
<a href="https://azure.microsoft.com/en-us/services/kubernetes-service/">Azure Container Service</a></p>
<h4 id="ekselasticcontainerserviceforkubernetes">EKS（Elastic Container Service for Kubernetes）</h4>
<p><amp-img src="https://drive.google.com/uc?id=1iWK1frglArGBlqbPCwJDbjnFQM7gkEnS&amp;export=download" alt="uc?id=1iWK1frglArGBlqbPCwJDbjnFQM7gkEnS&amp;export=download" width="503" height="140" layout="responsive"></amp-img><br />
EKS là Managed Kubernetes trên AWS được phát biểu ở sự kiện AWS re:Invent 2017<br />
Thông tin chi tiết các bạn tham khảo link bên dưới:<br />
<a href="https://aws.amazon.com/eks/?nc1=h_ls">Amazon EKS</a></p>
<h3 id="ktlun">Kết luận</h3>
<p>Bài viết lần này mình đã trình bày về các môi trường Kubernetes, trường hợp sử dụng trong thực tế, các môi trường có sự khác nhau ít nhiều, trong khả năng có thể hãy cố gắng kiến trúc các môi trường development/staging/production giống nhau.<br />
Mình đã cài đặt và dùng thử các môi trường như là Minikuber, Docker for Mac, Rancher, và Google Kubernetes Engine. Google Kubernetes Engine rất tuyệt vời các bạn ạ (không cần phải bàn). Nhưng xem xét chi phí thì cũng khá tốn kém đấy.<br />
Phần 3 loạt bài về Kubernetes mình sẽ giới thiệu chi tiết về cách thiết lập môi trường Kubernetes sử dụng Rancher 2.0 - dự án mình hiện cũng đang sử dụng.</p>


            </section>

        </article>
    </main>
    <footer class="page-footer">
        <h3>GMO-Z.com Vietnam Lab Center Technology Blog</h3>
            <p>Blog chia sẻ kỹ thuật của thành viên công ty GMO-Z.com Vietnam Lab Center</p>
        <p><a href="../../index.html">Read more posts →</a></p>
        <a class="powered" href="https://ghost.org" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 156 156"><g fill="none" fill-rule="evenodd"><rect fill="#15212B" width="156" height="156" rx="27"/><g transform="translate(36 36)" fill="#F6F8FA"><path d="M0 71.007A4.004 4.004 0 014 67h26a4 4 0 014 4.007v8.986A4.004 4.004 0 0130 84H4a4 4 0 01-4-4.007v-8.986zM50 71.007A4.004 4.004 0 0154 67h26a4 4 0 014 4.007v8.986A4.004 4.004 0 0180 84H54a4 4 0 01-4-4.007v-8.986z"/><rect y="34" width="84" height="17" rx="4"/><path d="M0 4.007A4.007 4.007 0 014.007 0h41.986A4.003 4.003 0 0150 4.007v8.986A4.007 4.007 0 0145.993 17H4.007A4.003 4.003 0 010 12.993V4.007z"/><rect x="67" width="17" height="17" rx="4"/></g></g></svg> Published with Ghost</a>
    </footer>
    
</body>
</html>
