<!DOCTYPE html>
<html ⚡>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">

    <title>Thực thi thuật toán k láng giềng gần nhất  K-Nearest Neighbour</title>

    <meta name="description" content="Trình bày một trong những thuật toán thường dùng trong machine learning đó là &quot;Thuật toán k láng giềng gần&quot;  K-Nearest Neighbour" />
    <link rel="canonical" href="../index.html" />
    <meta name="referrer" content="no-referrer-when-downgrade" />
    
    <meta property="og:site_name" content="GMO-Z.com Vietnam Lab Center Technology Blog" />
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Thực thi thuật toán k láng giềng gần nhất  K-Nearest Neighbour" />
    <meta property="og:description" content="Trình bày một trong những thuật toán thường dùng trong machine learning đó là &quot;Thuật toán k láng giềng gần&quot;  K-Nearest Neighbour" />
    <meta property="og:url" content="https://blog.vietnamlab.vn/thuc-thi-thuat-toan-k-lang-gieng-gan-nhat-k-nearest-neighbour/" />
    <meta property="og:image" content="https://drive.google.com/uc?id&#x3D;18l4r9nxPyIrhaYsjFKHEbz1khFThlv5t&amp;export&#x3D;download" />
    <meta property="article:published_time" content="2018-11-30T02:31:51.000Z" />
    <meta property="article:modified_time" content="2018-12-03T03:47:24.000Z" />
    <meta property="article:tag" content="machine learning" />
    <meta property="article:tag" content="Python3" />
    
    <meta property="article:publisher" content="https://www.facebook.com/vietnamlab.vn" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="Thực thi thuật toán k láng giềng gần nhất  K-Nearest Neighbour" />
    <meta name="twitter:description" content="Trình bày một trong những thuật toán thường dùng trong machine learning đó là &quot;Thuật toán k láng giềng gần&quot;  K-Nearest Neighbour" />
    <meta name="twitter:url" content="https://blog.vietnamlab.vn/thuc-thi-thuat-toan-k-lang-gieng-gan-nhat-k-nearest-neighbour/" />
    <meta name="twitter:image" content="https://drive.google.com/uc?id&#x3D;18l4r9nxPyIrhaYsjFKHEbz1khFThlv5t&amp;export&#x3D;download" />
    <meta name="twitter:label1" content="Written by" />
    <meta name="twitter:data1" content="T.C.Q" />
    <meta name="twitter:label2" content="Filed under" />
    <meta name="twitter:data2" content="machine learning, Python3" />
    <meta property="og:image:width" content="1600" />
    <meta property="og:image:height" content="886" />
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "GMO-Z.com Vietnam Lab Center Technology Blog",
        "url": "https://blog.vietnamlab.vn/",
        "logo": {
            "@type": "ImageObject",
            "url": "https://blog.vietnamlab.vn/favicon.ico",
            "width": 48,
            "height": 48
        }
    },
    "author": {
        "@type": "Person",
        "name": "T.C.Q",
        "image": {
            "@type": "ImageObject",
            "url": "https://drive.google.com/uc?id=1F8HRtTCzrnKzVWCm6NCYy8Hsyei_wlpa&export=download"
        },
        "url": "https://blog.vietnamlab.vn/author/quytc/",
        "sameAs": []
    },
    "headline": "Thực thi thuật toán k láng giềng gần nhất  K-Nearest Neighbour",
    "url": "https://blog.vietnamlab.vn/thuc-thi-thuat-toan-k-lang-gieng-gan-nhat-k-nearest-neighbour/",
    "datePublished": "2018-11-30T02:31:51.000Z",
    "dateModified": "2018-12-03T03:47:24.000Z",
    "image": {
        "@type": "ImageObject",
        "url": "https://drive.google.com/uc?id=18l4r9nxPyIrhaYsjFKHEbz1khFThlv5t&export=download",
        "width": 1600,
        "height": 886
    },
    "keywords": "machine learning, Python3",
    "description": " Xu hướng phát triển công nghệ thông tin ngày càng tăng, song song với nó lượng\ndữ liệu được sinh ra cũng ngày một lớn. Vì vậy nhu cầu để xử lý dữ liệu cũng lớn\nhơn, Machine Learning đang góp phần giải quyết vấn đề này. Trong bài này tôi\ntrình bày một trong những thuật toán thường dùng trong machine learning đó là\n&quot;Thuật toán k láng giềng gần&quot;  K-Nearest Neighbour\n\nI. Đặt vấn đề\n Giả sử một nhóm triển khai dịch vụ Quản Lý Ca [https://quanlyca.vn] ở thị\ntrường Việt Nam hiện tại có hai vị trí là S",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://blog.vietnamlab.vn/"
    }
}
    </script>

    <meta name="generator" content="Ghost 3.36" />
    <link rel="alternate" type="application/rss+xml" title="GMO-Z.com Vietnam Lab Center Technology Blog" href="../../rss/index.html" />

    <style amp-custom>
    *,
    *::before,
    *::after {
        box-sizing: border-box;
    }

    html {
        overflow-x: hidden;
        overflow-y: scroll;
        font-size: 62.5%;
        -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
    }

    body {
        min-height: 100vh;
        margin: 0;
        padding: 0;
        color: #3a4145;
        font-family: -apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Open Sans,Helvetica Neue,sans-serif;
        font-size: 1.7rem;
        line-height: 1.55em;
        font-weight: 400;
        font-style: normal;
        background: #fff;
        scroll-behavior: smooth;
        overflow-x: hidden;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
    }

    p,
    ul,
    ol,
    li,
    dl,
    dd,
    hr,
    pre,
    form,
    table,
    video,
    figure,
    figcaption,
    blockquote {
        margin: 0;
        padding: 0;
    }

    ul[class],
    ol[class] {
        padding: 0;
        list-style: none;
    }

    img {
        display: block;
        max-width: 100%;
    }

    input,
    button,
    select,
    textarea {
        font: inherit;
        -webkit-appearance: none;
    }

    fieldset {
        margin: 0;
        padding: 0;
        border: 0;
    }

    label {
        display: block;
        font-size: 0.9em;
        font-weight: 700;
    }

    hr {
        position: relative;
        display: block;
        width: 100%;
        height: 1px;
        border: 0;
        border-top: 1px solid currentcolor;
        opacity: 0.1;
    }

    ::selection {
        text-shadow: none;
        background: #cbeafb;
    }

    mark {
        background-color: #fdffb6;
    }

    small {
        font-size: 80%;
    }

    sub,
    sup {
        position: relative;
        font-size: 75%;
        line-height: 0;
        vertical-align: baseline;
    }
    sup {
        top: -0.5em;
    }
    sub {
        bottom: -0.25em;
    }

    ul li + li {
        margin-top: 0.6em;
    }

    a {
        color: #1292EE;
        text-decoration-skip-ink: auto;
    }

    h1,
    h2,
    h3,
    h4,
    h5,
    h6 {
        margin: 0;
        font-weight: 700;
        color: #121212;
        line-height: 1.4em;
    }

    h1 {
        font-size: 3.4rem;
        line-height: 1.1em;
    }

    h2 {
        font-size: 2.4rem;
        line-height: 1.2em;
    }

    h3 {
        font-size: 1.8rem;
    }

    h4 {
        font-size: 1.7rem;
    }

    h5 {
        font-size: 1.6rem;
    }

    h6 {
        font-size: 1.6rem;
    }

    amp-img {
        height: 100%;
        width: 100%;
        max-width: 100%;
        max-height: 100%;
    }

    amp-img img {
        object-fit: cover;
    }

    .page-header {
        padding: 50px 5vmin 30px;
        text-align: center;
        font-size: 2rem;
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }

    .page-header a {
        color: #121212;
        font-weight: 700;
        text-decoration: none;
        font-size: 1.6rem;
        letter-spacing: -0.1px;
    }

    .post {
        max-width: 680px;
        margin: 0 auto;
    }

    .post-header {
        margin: 0 5vmin 5vmin;
        text-align: center;
    }

    .post-meta {
        margin: 1rem 0 0 0;
        text-transform: uppercase;
        color: #738a94;
        font-weight: 500;
        font-size: 1.3rem;
    }

    .post-image {
        margin: 0 0 5vmin;
    }

    .post-image img {
        display: block;
        width: 100%;
        height: auto;
    }

    .post-content {
        padding: 0 5vmin;
    }

    .post-content > * + * {
        margin-top: 1.5em;
    }

    .post-content [id]:not(:first-child) {
        margin: 2em 0 0;
    }

    .post-content > [id] + * {
        margin-top: 1rem;
    }

    .post-content [id] + .kg-card,
    .post-content blockquote + .kg-card {
        margin-top: 40px;
    }

    .post-content > ul,
    .post-content > ol,
    .post-content > dl {
        padding-left: 1.9em;
    }

    .post-content hr {
        margin-top: 40px;
    }

    .post .post-content hr + * {
        margin-top: 40px;
    }

    .post-content amp-img {
        background-color: #f8f8f8;
    }

    .post-content blockquote {
        position: relative;
        font-style: italic;
    }

    .post-content blockquote::before {
        content: "";
        position: absolute;
        left: -1.5em;
        top: 0;
        bottom: 0;
        width: 0.3rem;
        background: #000;
    }

    .post-content :not(.kg-card):not([id]) + .kg-card {
        margin-top: 40px;
    }

    .post-content .kg-card + :not(.kg-card) {
        margin-top: 40px;
    }

    .kg-card figcaption {
        padding: 1.5rem 1.5rem 0;
        text-align: center;
        font-weight: 500;
        font-size: 1.3rem;
        line-height: 1.4em;
        opacity: 0.6;
    }

    .kg-card figcaption strong {
        color: rgba(0,0,0,0.8);
    }

    .post-content :not(pre) code {
        vertical-align: middle;
        padding: 0.15em 0.4em 0.15em;
        border: #e1eaef 1px solid;
        font-weight: 400;
        font-size: 0.9em;
        line-height: 1em;
        color: #dc0050;
        background: #f0f6f9;
        border-radius: 0.25em;
    }

    .post-content > pre {
        overflow: scroll;
        padding: 16px 20px;
        color: #fff;
        background: #1F2428;
        border-radius: 5px;
        box-shadow: 0 2px 6px -2px rgba(0,0,0,.1), 0 0 1px rgba(0,0,0,.4);
    }

    .kg-embed-card {
        display: flex;
        flex-direction: column;
        align-items: center;
        width: 100%;
    }

    .kg-image-card img {
        margin: auto;
    }

    .kg-gallery-card + .kg-gallery-card {
        margin-top: 0.75em;
    }

    .kg-gallery-container {
        position: relative;
    }

    .kg-gallery-row {
        display: flex;
        flex-direction: row;
        justify-content: center;
    }

    .kg-gallery-image {
        width: 100%;
        height: 100%;
    }

    .kg-gallery-row:not(:first-of-type) {
        margin: 0.75em 0 0 0;
    }

    .kg-gallery-image:not(:first-of-type) {
        margin: 0 0 0 0.75em;
    }

    .kg-bookmark-card,
    .kg-bookmark-publisher {
        position: relative;
    }

    .kg-bookmark-container,
    .kg-bookmark-container:hover {
        display: flex;
        flex-wrap: wrap;
        flex-direction: row-reverse;
        color: currentColor;
        background: rgba(255,255,255,0.6);
        font-family: -apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Open Sans,Helvetica Neue,sans-serif;
        text-decoration: none;
        border-radius: 5px;
        box-shadow: 0 2px 6px -2px rgba(0, 0, 0, 0.1), 0 0 1px rgba(0, 0, 0, 0.4);
        overflow: hidden;
    }

    .kg-bookmark-content {
        flex-basis: 0;
        flex-grow: 999;
        padding: 20px;
        order: 1;
    }

    .kg-bookmark-title {
        font-weight: 600;
        font-size: 1.5rem;
        line-height: 1.3em;
    }

    .kg-bookmark-description {
        display: -webkit-box;
        max-height: 45px;
        margin: 0.5em 0 0 0;
        font-size: 1.4rem;
        line-height: 1.55em;
        overflow: hidden;
        opacity: 0.8;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
    }

    .kg-bookmark-metadata {
        margin-top: 20px;
    }

    .kg-bookmark-metadata {
        display: flex;
        align-items: center;
        font-weight: 500;
        font-size: 1.3rem;
        line-height: 1.3em;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }

    .kg-bookmark-description {
        display: -webkit-box;
        -webkit-box-orient: vertical;
        -webkit-line-clamp: 2;
        overflow: hidden;
    }

    .kg-bookmark-metadata amp-img {
        width: 18px;
        height: 18px;
        max-width: 18px;
        max-height: 18px;
        margin-right: 10px;
    }

    .kg-bookmark-thumbnail {
        display: flex;
        flex-basis: 20rem;
        flex-grow: 1;
        justify-content: flex-end;
    }

    .kg-bookmark-thumbnail amp-img {
        max-height: 200px;
    }

    .kg-bookmark-author {
        white-space: nowrap;
        text-overflow: ellipsis;
        overflow: hidden;
    }

    .kg-bookmark-publisher::before {
        content: "•";
        margin: 0 .5em;
    }

    .kg-width-full.kg-card-hascaption {
        display: grid;
        grid-template-columns: inherit;
    }

    .post-content table {
        border-collapse: collapse;
        width: 100%;
    }

    .post-content th {
        padding: 0.5em 0.8em;
        text-align: left;
        font-size: .75em;
        text-transform: uppercase;
    }

    .post-content td {
        padding: 0.4em 0.7em;
    }

    .post-content tbody tr:nth-child(2n + 1) {
        background-color: rgba(0,0,0,0.1);
        padding: 1px;
    }

    .post-content tbody tr:nth-child(2n + 2) td:last-child {
        box-shadow:
            inset 1px 0 rgba(0,0,0,0.1),
            inset -1px 0 rgba(0,0,0,0.1);
    }

    .post-content tbody tr:nth-child(2n + 2) td {
        box-shadow: inset 1px 0 rgba(0,0,0,0.1);
    }

    .post-content tbody tr:last-child {
        border-bottom: 1px solid rgba(0,0,0,.1);
    }

    .page-footer {
        padding: 60px 5vmin;
        margin: 60px auto 0;
        text-align: center;
        background-color: #f8f8f8;
    }

    .page-footer h3 {
        margin: 0.5rem 0 0 0;
    }

    .page-footer p {
        max-width: 500px;
        margin: 1rem auto 1.5rem;
        font-size: 1.7rem;
        line-height: 1.5em;
        color: rgba(0,0,0,0.6)
    }

    .powered {
        display: inline-flex;
        align-items: center;
        margin: 30px 0 0;
        padding: 6px 9px 6px 6px;
        border: rgba(0,0,0,0.1) 1px solid;
        font-size: 12px;
        line-height: 12px;
        letter-spacing: -0.2px;
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Roboto", "Oxygen", "Ubuntu", "Cantarell", "Fira Sans", "Droid Sans", "Helvetica Neue", sans-serif;
        font-weight: 500;
        color: #222;
        text-decoration: none;
        background: #fff;
        border-radius: 6px;
    }

    .powered svg {
        height: 16px;
        width: 16px;
        margin: 0 6px 0 0;
    }

    @media (max-width: 600px) {
        body {
            font-size: 1.6rem;
        }
        h1 {
            font-size: 3rem;
        }

        h2 {
            font-size: 2.2rem;
        }
    }

    @media (max-width: 400px) {
        h1 {
            font-size: 2.6rem;
            line-height: 1.15em;
        }
        h2 {
            font-size: 2rem;
            line-height: 1.2em;
        }
        h3 {
            font-size: 1.7rem;
        }
    }
    </style>

    <style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style><noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript>
    <script async src="https://cdn.ampproject.org/v0.js"></script>

    

</head>

<body class="amp-template">
    <header class="page-header">
        <a href="../../index.html">
                GMO-Z.com Vietnam Lab Center Technology Blog
        </a>
    </header>

    <main class="content" role="main">
        <article class="post">

            <header class="post-header">
                <h1 class="post-title">Thực thi thuật toán k láng giềng gần nhất  K-Nearest Neighbour</h1>
                <section class="post-meta">
                    T.C.Q -
                    <time class="post-date" datetime="2018-11-30">30 Nov 2018</time>
                </section>
            </header>
            <figure class="post-image">
                <amp-img src="https://drive.google.com/uc?id&#x3D;18l4r9nxPyIrhaYsjFKHEbz1khFThlv5t&amp;export&#x3D;download" width="600" height="340" layout="responsive"></amp-img>
            </figure>
            <section class="post-content">

                <p> Xu hướng phát triển công nghệ thông tin ngày càng tăng, song song với nó lượng dữ liệu được sinh ra cũng ngày một lớn. Vì vậy nhu cầu để xử lý dữ liệu cũng lớn hơn, Machine Learning đang góp phần giải quyết vấn đề này. Trong bài này tôi trình bày một trong những thuật toán thường dùng trong machine learning đó là "Thuật toán k láng giềng gần"  K-Nearest Neighbour</p><h3 id="i-t-v-n-">I. Đặt vấn đề</h3><p> Giả sử một nhóm triển khai dịch vụ <a href="https://quanlyca.vn">Quản Lý Ca</a> ở thị trường Việt Nam hiện tại có hai vị trí là Sale và Tech. Hai vị trí này được đánh số điểm "<em><strong>Kỹ thuật</strong></em>" và "<em><strong>Kỹ năng mềm</strong></em>" khác nhau, từ những số điểm tôi sẽ gắn nhãn cho từng thành viên   </p><figure class="kg-card kg-image-card"><amp-img src="https://drive.google.com/uc?id=1WgJvqCA1IyVsT0I5B7R_HYLrZYRJuBTd&amp;export=download" class="kg-image" alt width="690" height="226" layout="responsive"></amp-img></figure><p>                                                                        <em> h1</em></p><figure class="kg-card kg-image-card"><amp-img src="https://drive.google.com/uc?id=1xBq-Szko_h9NBlxH577mU3UA8-ocsoFr&amp;export=download" class="kg-image" alt width="500" height="375" layout="responsive"></amp-img></figure><p>                                                                   <em>h2</em></p><p>Trong số những thành viên kể trên có duy nhất một người chưa được gắn nhãn là "Hoàng Anh", bài toán đặt ra là dựa theo dữ liệu có sẵn hãy phán đoán xem Hoàng Anh thuộc nhãn gì hay Hoàng Anh là Tech hay Sale.</p><p>Chúng ta xử lý bài toán này bằng cách đo khoảng cách <code>hình học</code> điểm "Kỹ thuật" và điểm "Kỹ năng mềm" của Hoàng Anh tới các thành viên khác, ta chọn ra ba thành viên gần nhất và hai trong số ba thành viên gần nhất có nhãn giống nhau và nhãn Hoàng Anh sẽ thuộc về đa số. <em>Cụ thể hình h1, ta có thể kết luận Hoàng Anh được sẽ gắn nhãn là Tech.</em> Vì khoảng cách của điểm kỹ năng của Hoàng Anh gần với hai thành viên mang nhãn Tech là Thành và Đạt và một thành viên mang nhãn Sale là An.</p><p>Chi tiết hơn, ta coi điểm "Tech" là trục y và điểm "Kỹ năng mềm" là trục x, dựa vào công thức ở hình h2 ta có kết quả ở cột khoảng cách như sau.</p><p><em>Ví dụ ta tính khoảng cách giữa Tuyết và Hoàng Anh thì công thức sẽ là</em></p><pre><code>SQRTPI(POWER(4.5-7,2) + POWER(8.7 - 3,2)) = 11.03201248</code></pre><p><em>※Công thức trên được tính bằng Excel</em></p><h3 id="ii-th-c-thi-b-i-to-n-c-th-b-ng-python">II. Thực thi bài toán cụ thể bằng python</h3><p> Trong ví dụ tiếp theo sử dụng ba thư viện của python đó là <code>cv2(OpenCV), numpy, matplotlib</code></p><p>Tạo ra một loạt đối tượng hình vuông, hình tam giác. Sau đó tạo ngẫu nhiên một hình tròn và phán đoán xem hình tròn đó là hình thuộc loại hình vuông hay hình tam giác.</p><p>Đầu tiên lấy ngẫu nhiên 25 phần từ từ 0 tới 100 và lấy ngẫu nhiên 25 phần từ 0 và 1 như  sau:</p><pre><code>import cv2
import numpy as np
import matplotlib.pyplot as plt

# Lấy ngẫu nhiên 25 phần tử từ 0 tới 100 và gán nó kiểu số thực mảng hai chiều
trainData = np.random.randint(0, 100, (25, 2)).astype(np.float32)

# Lấy ngẫu nhiên 25 phần từ 0 và 1
ketqua = np.random.randint(0, 2, (25, 1)).astype(np.float32)

print trainData
print ketqua</code></pre><p>Output:</p><pre><code>$ python knearestbeighbour.py 
[[ 7. 53.]
 [54. 69.]
 [45. 20.]
 [16. 43.]
 [97. 37.]
 [ 7. 28.]
 [46. 85.]
 [69. 10.]
 [64. 73.]
 [59. 90.]
 [37. 43.]
 [19. 32.]
 [25.  7.]
 [15. 85.]
 [49. 83.]
 [17. 69.]
 [87. 29.]
 [95. 11.]
 [79. 35.]
 [ 9. 66.]
 [45. 29.]
 [47. 32.]
 [87. 84.]
 [83. 47.]
 [39. 40.]]
[[0.]
 [1.]
 [1.]
 [1.]
 [0.]
 [0.]
 [1.]
 [1.]
 [0.]
 [0.]
 [1.]
 [1.]
 [1.]
 [0.]
 [1.]
 [0.]
 [1.]
 [1.]
 [0.]
 [0.]
 [0.]
 [0.]
 [1.]
 [1.]
 [0.]]</code></pre><p>Tiếp theo, ở mảng <em><strong>ketqua</strong></em> ta quy định "Hình vuông" là 1 và "Hình tam giác" là 0, đồng thời tạo ra một phần tử random như sau:</p><pre><code> ....

# Lấy những phần tử có ketqua = 1 từ traindata
red = trainData[ketqua.ravel() == 1]

# Lấy những phần tử cso ketqua = 0 từ traindata
blue = trainData[ketqua.ravel() == 0]

#Lấy ngẫu nhiên một một phần tử trong khoảng từ 0 và 100
newMember = np.random.randint(0, 100, (1, 2)).astype(np.float32)

# Ta In kết quả ra như sau
print '======Red ============'
print red

print '======blue ============'
print blue

print '======New member ============'
print newMember
</code></pre><p>Output:</p><pre><code>$ python knearestbeighbour.py 
======Red ============
[[39. 89.]
 [78. 12.]
 [21. 84.]
 [79. 40.]
 [ 1. 38.]
 [82. 51.]
 [18. 31.]
 [62. 11.]
 [ 0.  2.]
 [67.  7.]
 [ 6. 82.]
 [18. 71.]
 [18. 71.]]
======blue ============
[[12. 90.]
 [94. 62.]
 [80. 41.]
 [ 7. 38.]
 [ 1. 64.]
 [67. 68.]
 [74.  6.]
 [40. 37.]
 [ 8. 14.]
 [12.  5.]
 [71.  6.]
 [11. 79.]]
======New member ============
[[19. 82.]]</code></pre><p>Tiếp theo, ta dùng thư viện <code>matplotlib</code> để hiển thị các hình vuông, hình tam giác, hình tròn.</p><pre><code>......

plt.scatter(red[:, 0], red[:, 1], 100, 'r', 's')
plt.scatter(blue[:, 0], blue[:, 1], 100, 'b', '^')
plt.scatter(newMember[:, 0], newMember[:, 1], 100, 'g', 'o')

plt.show()</code></pre><p>Output:</p><figure class="kg-card kg-image-card"><amp-img src="https://drive.google.com/uc?id=18jhauUhPNGJtTkoRwKq7J8IMYx6FJRC0&amp;export=download" class="kg-image" alt width="1280" height="960" layout="responsive"></amp-img></figure><p>Hình tròn xanh chính là phần tử ngẫu nhiên mà chưa biết thuộc nhóm vuông hay tam giác</p><p>Bây giờ, sẽ dùng thuật toán <em><strong>K-Nearest Neighbour</strong></em> để tìm xem hình tròn nó gần nhất với nhiều hình vuông hơn hay tam giác hơn. ta tìm ba phần gần nhất nếu phần tử nào chiếm đa số thì kết luận hình tròn sẽ thuộc lớp đó. Có nghĩa là gần nhất những thằng nào thì cùng loại với nó.</p><pre><code>....

# Khởi tạo thuạt toán KNearest
knn = cv2.ml.KNearest_create()

# Training data
knn.train(trainData, 0, ketqua)

# In kêt quả resut = 1 =&gt; vuông, 0 -&gt; tam giác
temp, result, nearest, distance = knn.findNearest(newMember, 3)

print("Result: {}\n".format(result))
print("Nearest: {}\n".format(nearest))
print("Distance: {}\n".format(distance))


plt.show()</code></pre><p>Output:</p><pre><code>Result: [[0.]]

Nearest: [[0. 0. 0.]]

Distance: [[400. 442. 521.]]</code></pre><figure class="kg-card kg-image-card"><amp-img src="https://drive.google.com/uc?id=1kaVoq4W1uWBl7qg8zZR-uasuxWC5AWwe&amp;export=download" class="kg-image" alt width="1280" height="960" layout="responsive"></amp-img></figure><p> Quan sát hình trên sẽ thấy, hình tròn thuộc lớp tam giác do nó gần những thằng tam giác nhất.</p><p>Code đầy đủ:</p><pre><code>import cv2
import numpy as np
import matplotlib.pyplot as plt

trainData = np.random.randint(0, 100, (25, 2)).astype(np.float32)
ketqua = np.random.randint(0, 2, (25, 1)).astype(np.float32)

red = trainData[ketqua.ravel() == 1]
blue = trainData[ketqua.ravel() == 0]
newMember = np.random.randint(0, 100, (1, 2)).astype(np.float32)

plt.scatter(red[:, 0], red[:, 1], 100, 'r', 's')
plt.scatter(blue[:, 0], blue[:, 1], 100, 'b', '^')
plt.scatter(newMember[:, 0], newMember[:, 1], 100, 'g', 'o')

knn = cv2.ml.KNearest_create()
knn.train(trainData, 0, ketqua)
temp, result, nearest, distance = knn.findNearest(newMember, 3)

print("Result: {}\n".format(result))
print("Nearest: {}\n".format(nearest))
print("Distance: {}\n".format(distance))

plt.show()</code></pre><h3 id="iii-k-t-lu-n">III. Kết luận</h3><p> Trên đây tôi trình bày cách thực thi thuật toán k láng giềng gần nhất(<strong><em>K-Nearest Neighbour</em></strong>) bằng một ví dụ đơn giản nhất. Bài viết này tôi muốn trình bày những vấn đề phức tạp một cách đơn giản và dễ hiểu nhất, bằng những ví dụ đơn giản nhất. Hy vọng giúp ích được phần nào đó cho độc giả.</p><h3 id="iv-linh-tham-kh-o">IV. Linh tham khảo</h3><ul>
<li><a href="https://scikit-learn.org/stable/modules/generated/sklearn.neighbors.NearestNeighbors.html#sklearn.neighbors.NearestNeighbors">sklearn.neighbors.NearestNeighbors</a></li>
</ul>
<ul>
<li><a href="http://scikit-learn.org/stable/modules/generated/sklearn.model_selection.train_test_split.html">sklearn.model_selection.train_test_split</a></li>
</ul>
<ul>
<li><a href="http://machinelearningmastery.com/tutorial-to-implement-k-nearest-neighbors-in-python-from-scratch/">Tutorial To Implement k-Nearest Neighbors in Python From Scratch</a></li>
</ul>


            </section>

        </article>
    </main>
    <footer class="page-footer">
        <h3>GMO-Z.com Vietnam Lab Center Technology Blog</h3>
            <p>Blog chia sẻ kỹ thuật của thành viên công ty GMO-Z.com Vietnam Lab Center</p>
        <p><a href="../../index.html">Read more posts →</a></p>
        <a class="powered" href="https://ghost.org" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 156 156"><g fill="none" fill-rule="evenodd"><rect fill="#15212B" width="156" height="156" rx="27"/><g transform="translate(36 36)" fill="#F6F8FA"><path d="M0 71.007A4.004 4.004 0 014 67h26a4 4 0 014 4.007v8.986A4.004 4.004 0 0130 84H4a4 4 0 01-4-4.007v-8.986zM50 71.007A4.004 4.004 0 0154 67h26a4 4 0 014 4.007v8.986A4.004 4.004 0 0180 84H54a4 4 0 01-4-4.007v-8.986z"/><rect y="34" width="84" height="17" rx="4"/><path d="M0 4.007A4.007 4.007 0 014.007 0h41.986A4.003 4.003 0 0150 4.007v8.986A4.007 4.007 0 0145.993 17H4.007A4.003 4.003 0 010 12.993V4.007z"/><rect x="67" width="17" height="17" rx="4"/></g></g></svg> Published with Ghost</a>
    </footer>
    
</body>
</html>
