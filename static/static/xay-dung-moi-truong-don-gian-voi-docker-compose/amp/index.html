<!DOCTYPE html>
<html ⚡>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">

    <title>Xây dựng môi trường đơn giản với Docker Compose</title>

    <link rel="canonical" href="../index.html" />
    <meta name="referrer" content="no-referrer-when-downgrade" />
    
    <meta property="og:site_name" content="GMO-Z.com Vietnam Lab Center Technology Blog" />
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Xây dựng môi trường đơn giản với Docker Compose" />
    <meta property="og:description" content="Đối với mỗi quá trình phát triển một web application, việc xây dựng môi trường phát triển là không thể thiếu. Thời đại Devops chưa thực sự rõ ràng, các developer thường tự cài đặt trên máy thật của chính mình, như là cái XAMPP nếu code PHP, cài JDK" />
    <meta property="og:url" content="https://blog.vietnamlab.vn/xay-dung-moi-truong-don-gian-voi-docker-compose/" />
    <meta property="og:image" content="https://drive.google.com/uc?id&#x3D;1IN0NzU8HaKs24iv5QtMH4yPa_2903qrE&amp;export&#x3D;download" />
    <meta property="article:published_time" content="2019-03-22T01:34:00.000Z" />
    <meta property="article:modified_time" content="2019-03-22T01:34:00.000Z" />
    <meta property="article:tag" content="docker" />
    <meta property="article:tag" content="docker compose" />
    
    <meta property="article:publisher" content="https://www.facebook.com/vietnamlab.vn" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="Xây dựng môi trường đơn giản với Docker Compose" />
    <meta name="twitter:description" content="Đối với mỗi quá trình phát triển một web application, việc xây dựng môi trường phát triển là không thể thiếu. Thời đại Devops chưa thực sự rõ ràng, các developer thường tự cài đặt trên máy thật của chính mình, như là cái XAMPP nếu code PHP, cài JDK" />
    <meta name="twitter:url" content="https://blog.vietnamlab.vn/xay-dung-moi-truong-don-gian-voi-docker-compose/" />
    <meta name="twitter:image" content="https://drive.google.com/uc?id&#x3D;1IN0NzU8HaKs24iv5QtMH4yPa_2903qrE&amp;export&#x3D;download" />
    <meta name="twitter:label1" content="Written by" />
    <meta name="twitter:data1" content="T.P.H" />
    <meta name="twitter:label2" content="Filed under" />
    <meta name="twitter:data2" content="docker, docker compose" />
    <meta property="og:image:width" content="1000" />
    <meta property="og:image:height" content="390" />
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "GMO-Z.com Vietnam Lab Center Technology Blog",
        "url": "https://blog.vietnamlab.vn/",
        "logo": {
            "@type": "ImageObject",
            "url": "https://blog.vietnamlab.vn/favicon.ico",
            "width": 48,
            "height": 48
        }
    },
    "author": {
        "@type": "Person",
        "name": "T.P.H",
        "image": {
            "@type": "ImageObject",
            "url": "//www.gravatar.com/avatar/47245480087cd133dc949e0363a87263?s=250&d=mm&r=x",
            "width": 250,
            "height": 250
        },
        "url": "https://blog.vietnamlab.vn/author/hoantp/",
        "sameAs": []
    },
    "headline": "Xây dựng môi trường đơn giản với Docker Compose",
    "url": "https://blog.vietnamlab.vn/xay-dung-moi-truong-don-gian-voi-docker-compose/",
    "datePublished": "2019-03-22T01:34:00.000Z",
    "dateModified": "2019-03-22T01:34:00.000Z",
    "image": {
        "@type": "ImageObject",
        "url": "https://drive.google.com/uc?id=1IN0NzU8HaKs24iv5QtMH4yPa_2903qrE&export=download",
        "width": 1000,
        "height": 390
    },
    "keywords": "docker, docker compose",
    "description": "Đối với mỗi quá trình phát triển một web application, việc xây dựng môi trường\nphát triển là không thể thiếu. Thời đại Devops chưa thực sự rõ ràng, các\ndeveloper thường tự cài đặt trên máy thật của chính mình, như là cái XAMPP nếu\ncode PHP, cài JDK với Java,... và cả các Database căn bản.\n\nSau đó với sự ra đời của Vagrant, kết hợp với ứng dụng tạo máy ảo miễn phí\nVirtualbox, dần dần việc cài đặt trở nên linh hoạt và hiệu quả hơn, cô lập mức\ntới mức OS để giữ cho máy thật ổn định.\n\nSự phát triển ",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://blog.vietnamlab.vn/"
    }
}
    </script>

    <meta name="generator" content="Ghost 3.36" />
    <link rel="alternate" type="application/rss+xml" title="GMO-Z.com Vietnam Lab Center Technology Blog" href="../../rss/index.html" />

    <style amp-custom>
    *,
    *::before,
    *::after {
        box-sizing: border-box;
    }

    html {
        overflow-x: hidden;
        overflow-y: scroll;
        font-size: 62.5%;
        -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
    }

    body {
        min-height: 100vh;
        margin: 0;
        padding: 0;
        color: #3a4145;
        font-family: -apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Open Sans,Helvetica Neue,sans-serif;
        font-size: 1.7rem;
        line-height: 1.55em;
        font-weight: 400;
        font-style: normal;
        background: #fff;
        scroll-behavior: smooth;
        overflow-x: hidden;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
    }

    p,
    ul,
    ol,
    li,
    dl,
    dd,
    hr,
    pre,
    form,
    table,
    video,
    figure,
    figcaption,
    blockquote {
        margin: 0;
        padding: 0;
    }

    ul[class],
    ol[class] {
        padding: 0;
        list-style: none;
    }

    img {
        display: block;
        max-width: 100%;
    }

    input,
    button,
    select,
    textarea {
        font: inherit;
        -webkit-appearance: none;
    }

    fieldset {
        margin: 0;
        padding: 0;
        border: 0;
    }

    label {
        display: block;
        font-size: 0.9em;
        font-weight: 700;
    }

    hr {
        position: relative;
        display: block;
        width: 100%;
        height: 1px;
        border: 0;
        border-top: 1px solid currentcolor;
        opacity: 0.1;
    }

    ::selection {
        text-shadow: none;
        background: #cbeafb;
    }

    mark {
        background-color: #fdffb6;
    }

    small {
        font-size: 80%;
    }

    sub,
    sup {
        position: relative;
        font-size: 75%;
        line-height: 0;
        vertical-align: baseline;
    }
    sup {
        top: -0.5em;
    }
    sub {
        bottom: -0.25em;
    }

    ul li + li {
        margin-top: 0.6em;
    }

    a {
        color: #1292EE;
        text-decoration-skip-ink: auto;
    }

    h1,
    h2,
    h3,
    h4,
    h5,
    h6 {
        margin: 0;
        font-weight: 700;
        color: #121212;
        line-height: 1.4em;
    }

    h1 {
        font-size: 3.4rem;
        line-height: 1.1em;
    }

    h2 {
        font-size: 2.4rem;
        line-height: 1.2em;
    }

    h3 {
        font-size: 1.8rem;
    }

    h4 {
        font-size: 1.7rem;
    }

    h5 {
        font-size: 1.6rem;
    }

    h6 {
        font-size: 1.6rem;
    }

    amp-img {
        height: 100%;
        width: 100%;
        max-width: 100%;
        max-height: 100%;
    }

    amp-img img {
        object-fit: cover;
    }

    .page-header {
        padding: 50px 5vmin 30px;
        text-align: center;
        font-size: 2rem;
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }

    .page-header a {
        color: #121212;
        font-weight: 700;
        text-decoration: none;
        font-size: 1.6rem;
        letter-spacing: -0.1px;
    }

    .post {
        max-width: 680px;
        margin: 0 auto;
    }

    .post-header {
        margin: 0 5vmin 5vmin;
        text-align: center;
    }

    .post-meta {
        margin: 1rem 0 0 0;
        text-transform: uppercase;
        color: #738a94;
        font-weight: 500;
        font-size: 1.3rem;
    }

    .post-image {
        margin: 0 0 5vmin;
    }

    .post-image img {
        display: block;
        width: 100%;
        height: auto;
    }

    .post-content {
        padding: 0 5vmin;
    }

    .post-content > * + * {
        margin-top: 1.5em;
    }

    .post-content [id]:not(:first-child) {
        margin: 2em 0 0;
    }

    .post-content > [id] + * {
        margin-top: 1rem;
    }

    .post-content [id] + .kg-card,
    .post-content blockquote + .kg-card {
        margin-top: 40px;
    }

    .post-content > ul,
    .post-content > ol,
    .post-content > dl {
        padding-left: 1.9em;
    }

    .post-content hr {
        margin-top: 40px;
    }

    .post .post-content hr + * {
        margin-top: 40px;
    }

    .post-content amp-img {
        background-color: #f8f8f8;
    }

    .post-content blockquote {
        position: relative;
        font-style: italic;
    }

    .post-content blockquote::before {
        content: "";
        position: absolute;
        left: -1.5em;
        top: 0;
        bottom: 0;
        width: 0.3rem;
        background: #000;
    }

    .post-content :not(.kg-card):not([id]) + .kg-card {
        margin-top: 40px;
    }

    .post-content .kg-card + :not(.kg-card) {
        margin-top: 40px;
    }

    .kg-card figcaption {
        padding: 1.5rem 1.5rem 0;
        text-align: center;
        font-weight: 500;
        font-size: 1.3rem;
        line-height: 1.4em;
        opacity: 0.6;
    }

    .kg-card figcaption strong {
        color: rgba(0,0,0,0.8);
    }

    .post-content :not(pre) code {
        vertical-align: middle;
        padding: 0.15em 0.4em 0.15em;
        border: #e1eaef 1px solid;
        font-weight: 400;
        font-size: 0.9em;
        line-height: 1em;
        color: #dc0050;
        background: #f0f6f9;
        border-radius: 0.25em;
    }

    .post-content > pre {
        overflow: scroll;
        padding: 16px 20px;
        color: #fff;
        background: #1F2428;
        border-radius: 5px;
        box-shadow: 0 2px 6px -2px rgba(0,0,0,.1), 0 0 1px rgba(0,0,0,.4);
    }

    .kg-embed-card {
        display: flex;
        flex-direction: column;
        align-items: center;
        width: 100%;
    }

    .kg-image-card img {
        margin: auto;
    }

    .kg-gallery-card + .kg-gallery-card {
        margin-top: 0.75em;
    }

    .kg-gallery-container {
        position: relative;
    }

    .kg-gallery-row {
        display: flex;
        flex-direction: row;
        justify-content: center;
    }

    .kg-gallery-image {
        width: 100%;
        height: 100%;
    }

    .kg-gallery-row:not(:first-of-type) {
        margin: 0.75em 0 0 0;
    }

    .kg-gallery-image:not(:first-of-type) {
        margin: 0 0 0 0.75em;
    }

    .kg-bookmark-card,
    .kg-bookmark-publisher {
        position: relative;
    }

    .kg-bookmark-container,
    .kg-bookmark-container:hover {
        display: flex;
        flex-wrap: wrap;
        flex-direction: row-reverse;
        color: currentColor;
        background: rgba(255,255,255,0.6);
        font-family: -apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Open Sans,Helvetica Neue,sans-serif;
        text-decoration: none;
        border-radius: 5px;
        box-shadow: 0 2px 6px -2px rgba(0, 0, 0, 0.1), 0 0 1px rgba(0, 0, 0, 0.4);
        overflow: hidden;
    }

    .kg-bookmark-content {
        flex-basis: 0;
        flex-grow: 999;
        padding: 20px;
        order: 1;
    }

    .kg-bookmark-title {
        font-weight: 600;
        font-size: 1.5rem;
        line-height: 1.3em;
    }

    .kg-bookmark-description {
        display: -webkit-box;
        max-height: 45px;
        margin: 0.5em 0 0 0;
        font-size: 1.4rem;
        line-height: 1.55em;
        overflow: hidden;
        opacity: 0.8;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
    }

    .kg-bookmark-metadata {
        margin-top: 20px;
    }

    .kg-bookmark-metadata {
        display: flex;
        align-items: center;
        font-weight: 500;
        font-size: 1.3rem;
        line-height: 1.3em;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }

    .kg-bookmark-description {
        display: -webkit-box;
        -webkit-box-orient: vertical;
        -webkit-line-clamp: 2;
        overflow: hidden;
    }

    .kg-bookmark-metadata amp-img {
        width: 18px;
        height: 18px;
        max-width: 18px;
        max-height: 18px;
        margin-right: 10px;
    }

    .kg-bookmark-thumbnail {
        display: flex;
        flex-basis: 20rem;
        flex-grow: 1;
        justify-content: flex-end;
    }

    .kg-bookmark-thumbnail amp-img {
        max-height: 200px;
    }

    .kg-bookmark-author {
        white-space: nowrap;
        text-overflow: ellipsis;
        overflow: hidden;
    }

    .kg-bookmark-publisher::before {
        content: "•";
        margin: 0 .5em;
    }

    .kg-width-full.kg-card-hascaption {
        display: grid;
        grid-template-columns: inherit;
    }

    .post-content table {
        border-collapse: collapse;
        width: 100%;
    }

    .post-content th {
        padding: 0.5em 0.8em;
        text-align: left;
        font-size: .75em;
        text-transform: uppercase;
    }

    .post-content td {
        padding: 0.4em 0.7em;
    }

    .post-content tbody tr:nth-child(2n + 1) {
        background-color: rgba(0,0,0,0.1);
        padding: 1px;
    }

    .post-content tbody tr:nth-child(2n + 2) td:last-child {
        box-shadow:
            inset 1px 0 rgba(0,0,0,0.1),
            inset -1px 0 rgba(0,0,0,0.1);
    }

    .post-content tbody tr:nth-child(2n + 2) td {
        box-shadow: inset 1px 0 rgba(0,0,0,0.1);
    }

    .post-content tbody tr:last-child {
        border-bottom: 1px solid rgba(0,0,0,.1);
    }

    .page-footer {
        padding: 60px 5vmin;
        margin: 60px auto 0;
        text-align: center;
        background-color: #f8f8f8;
    }

    .page-footer h3 {
        margin: 0.5rem 0 0 0;
    }

    .page-footer p {
        max-width: 500px;
        margin: 1rem auto 1.5rem;
        font-size: 1.7rem;
        line-height: 1.5em;
        color: rgba(0,0,0,0.6)
    }

    .powered {
        display: inline-flex;
        align-items: center;
        margin: 30px 0 0;
        padding: 6px 9px 6px 6px;
        border: rgba(0,0,0,0.1) 1px solid;
        font-size: 12px;
        line-height: 12px;
        letter-spacing: -0.2px;
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Roboto", "Oxygen", "Ubuntu", "Cantarell", "Fira Sans", "Droid Sans", "Helvetica Neue", sans-serif;
        font-weight: 500;
        color: #222;
        text-decoration: none;
        background: #fff;
        border-radius: 6px;
    }

    .powered svg {
        height: 16px;
        width: 16px;
        margin: 0 6px 0 0;
    }

    @media (max-width: 600px) {
        body {
            font-size: 1.6rem;
        }
        h1 {
            font-size: 3rem;
        }

        h2 {
            font-size: 2.2rem;
        }
    }

    @media (max-width: 400px) {
        h1 {
            font-size: 2.6rem;
            line-height: 1.15em;
        }
        h2 {
            font-size: 2rem;
            line-height: 1.2em;
        }
        h3 {
            font-size: 1.7rem;
        }
    }
    </style>

    <style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style><noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript>
    <script async src="https://cdn.ampproject.org/v0.js"></script>

    

</head>

<body class="amp-template">
    <header class="page-header">
        <a href="../../index.html">
                GMO-Z.com Vietnam Lab Center Technology Blog
        </a>
    </header>

    <main class="content" role="main">
        <article class="post">

            <header class="post-header">
                <h1 class="post-title">Xây dựng môi trường đơn giản với Docker Compose</h1>
                <section class="post-meta">
                    T.P.H -
                    <time class="post-date" datetime="2019-03-22">22 Mar 2019</time>
                </section>
            </header>
            <figure class="post-image">
                <amp-img src="https://drive.google.com/uc?id&#x3D;1IN0NzU8HaKs24iv5QtMH4yPa_2903qrE&amp;export&#x3D;download" width="600" height="340" layout="responsive"></amp-img>
            </figure>
            <section class="post-content">

                <p>Đối với mỗi quá trình phát triển một web application, việc xây dựng môi trường phát triển là không thể thiếu. Thời đại Devops chưa thực sự rõ ràng, các developer thường tự cài đặt trên máy thật của chính mình, như là cái XAMPP nếu code PHP, cài JDK với Java,... và cả các Database căn bản.</p>
<p>Sau đó với sự ra đời của Vagrant, kết hợp với ứng dụng tạo máy ảo miễn phí Virtualbox, dần dần việc cài đặt trở nên linh hoạt và hiệu quả hơn, cô lập mức tới mức OS để giữ cho máy thật ổn định.</p>
<p>Sự phát triển không ngừng của phần Devops vốn không kém phần quan trọng, thì <a href="https://blog.vietnamlab.vn/2017/03/25/docker-co-gi-hay/">Docker</a> đã đời, đặc biệt có Kubenetes hiện đang làm mưa làm gió ở trong ngành để giải quyết các vấn đề trong hệ thống cực lớn... Vậy với các hệ thống nhỏ thì sao?</p>
<p>Hôm nay mình xin giới thiệu Docker Compose với cách thiết lập hết sức căn bản để xây dựng môi trường dev cho Laravel.</p>
<h3 id="1cit">1. Cài đặt</h3>
<p>Docker compose vốn là công cụ để định nghĩa và quản lý container trong Docker một cách rõ ràng và rành mạch nhất. Trước hết, chúng ta cần cài đặt Docker đã.</p>
<p><a href="https://docs.docker.com/install/linux/docker-ce/centos/">https://docs.docker.com/install/linux/docker-ce/centos/</a><br />
(*) Đối với các OS khác, bạn có thể nhìn sang sidebar bên trái để lựa chọn phù hợp.</p>
<p>Sau đó bạn tiếp tục vào <a href="https://docs.docker.com/compose/install/">trang này</a>, lựa chọn OS phù hợp và chạy command theo hướng dẫn để tải và cài đặt docker compose.</p>
<pre><code class="language-sh"># Tải docker compose
$ sudo curl -L "https://github.com/docker/compose/releases/download/1.23.2/docker-compose-$(uname -s)-$(uname -m)" -o /usr/local/bin/docker-compose

# Thêm quyền execute cho file
$ sudo chmod +x /usr/local/bin/docker-compose
</code></pre>
<p>Vậy là chúng ta đã xong bước cài đặt.</p>
<h3 id="2cuhnh">2. Cấu hình</h3>
<p>Docker compose sử dụng YAML file để cấu hình các container, những ai đã làm với Ansible có lẽ đã rất quen thuộc với định dạng này, rất rõ ràng, đơn giản mà lại vô cùng dễ hiểu.</p>
<p>Mặc định docker compose sẽ đọc từ file <code>docker-compose.yml</code>, bước đầu thiết kế một môi trường ta cần định nghĩa rõ các thành phần cần thiết, ở đây, mình sẽ thử thiết lập môi trường cho một ứng dụng Laravel, ta sẽ cần tối thiểu:</p>
<ul>
<li>Nginx: dùng làm proxy server chuyển request cho PHP-FPM xử lý.</li>
<li>PHP-FPM: dùng để compile code php của Laravel.</li>
<li>MariaDB: cơ sở dữ liệu.</li>
</ul>
<p><code>docker-compose.yml</code>:</p>
<pre><code class="language-yml">version: '3'

services:
    web:
        image: nginx:1.11.9
        ports:
            - "80:80"
            - "443:443"
        depends_on:
            - php
        volumes:
            - /var/www/web:/var/www/web
            - ./nginx/nginx.conf:/etc/nginx/nginx.conf
            - ./nginx/config/vnlab_dev.conf:/etc/nginx/conf.d/default.conf
        restart: always
        networks:
            - app-network

    php:
        build: ./php
        image: php_fpm:7.1
        working_dir: /var/www/web
        depends_on:
            - database
        volumes:
            - /var/www/web:/var/www/web
        restart: always
        networks:
            - app-network

    database:
        image: mariadb:10.1
        volumes:
            - vietnamlab_db:/var/lib/mysql
        restart: always
        environment:
            MYSQL_ROOT_PASSWORD: 'root'
            MYSQL_DATABASE: 'vnlab'
            MYSQL_USER: 'vnlab'
            MYSQL_PASSWORD: 'vnlab'
        networks:
            - app-network

volumes:
    vietnamlab_db:

networks:
    app-network:
        driver: bridge

</code></pre>
<p>Với các parameter được thiết lập, bạn dễ dàng tìm thấy tài liệu ở trên chính <a href="https://docs.docker.com/compose/compose-file/">trang chủ của Docker compose</a>. Nhưng hiểu nhanh gọn, mình sẽ giải thích đơn giản:</p>
<ul>
<li><code>build</code>: Nơi có <code>Dockerfile</code> để build lên một image.</li>
<li><code>image</code>: Đọc file image từ bên trong hệ thống, nếu không tìm thấy nó sẽ tìm trên Docker Hub hoặc Private Registry (nếu có) để tải về và sử dụng.</li>
<li><code>working_dir</code>: Trỏ trực tiếp để ngay thư mục mà bạn muốn container trỏ và thao tác ngay trên đó (như chạy command, bash,...)</li>
<li><code>volumes</code>: map folder/file từ ngoài máy thật vào trong container, hoặc map từ Docker Volume vào bên trong máy ảo, chi tiết về các loại volume bạn tham khảm <a href="https://docs.docker.com/storage/volumes/">tại đây</a>.</li>
<li><code>networks</code>: Áp dụng một/hoặc nhiều network cho container đó. Ở đây cả 3 sẽ sử dụng chung một private network tên là <code>app-network</code> được định nghĩa bên dưới.</li>
<li><code>environment</code>: Thiết lập các biến môi trường để dụng bên trong container.</li>
</ul>
<p>Như ở trên có thể thấy mình đã mount: <code>/var/www/web</code> từ máy thật <code>/var/www/web</code> vào bên trong container, nó chứa source của Laravel để chạy. Tiếp đó mình mount: <code>./nginx/nginx.conf:/etc/nginx/nginx.conf</code> và <code>./nginx/config/vnlab_dev.conf:/etc/nginx/conf.d/default.conf</code> để thiết lập proxy trỏ tới PHP-FPM.</p>
<p><code>./nginx/config/vnlab_dev.conf</code>:</p>
<pre><code>server {
        listen       80 default_server;
        server_name  laravel;
        root /var/www/web/public;

        client_max_body_size 64M;

        location ~* /(?:uploads|files)/.*\.php$ {
                deny all;
        }

        location / {
                index index.php index.html index.htm;
                try_files $uri $uri/ /index.php?$args;
        }

        location ~* \.(gif|jpg|jpeg|png|css|js)$ {
                expires max;
        }

        location ~ \.php$ {
                try_files $uri =404;

                fastcgi_split_path_info ^(.+\.php)(/.+)$;
                fastcgi_index   index.php;
                fastcgi_pass    php:9000;
                include         fastcgi_params;
                fastcgi_param   SCRIPT_FILENAME    $document_root$fastcgi_script_name;
                fastcgi_param   SCRIPT_NAME        $fastcgi_script_name;
        }
}

</code></pre>
<p>Cuối cùng, để chạy được Laravel, chúng ta không thể chỉ sử dụng image <code>php-fpm</code> đơn thuần được mà sẽ cần phải cài thêm một vài packages cần thiết, để cài chúng ta sẽ cần viết một <code>Dockerfile</code> đơn giản.</p>
<p><code>./php/Dockerfile</code>:</p>
<pre><code class="language-yml">FROM php:7.1-fpm

RUN apt-get update

RUN apt-get install -y libmcrypt-dev unzip &amp;&amp; \
    docker-php-ext-install mbstring mcrypt pdo_mysql

RUN groupmod -g 1000 www-data &amp;&amp; \
    usermod -u 1000 www-data

# Chú ý: File này sẽ cần tạo riêng nếu muốn thay đổi cài đặt gốc!!!
COPY php.ini /usr/local/etc/php/
</code></pre>
<h3 id="3chyth">3. Chạy thử</h3>
<p>Sau khi đã thiết lập xong toàn bộ các bước trên, kiểm tra lại các cấu hình, ta sẽ chạy duy nhất một lệnh để Docker tải và thiết lập các container như mong muốn.</p>
<pre><code>$ docker-compose up -d
</code></pre>
<p>Cực kì đơn giản và tiện lợi phải không nào? ^^!</p>
<p>Như có thể thấy, đối với việc xây dựng môi trường dev ở local, hoặc đối với các dự án nhỏ thì Docker Compose rất tiện lợi và nhanh chóng. Hẹn gặp lại các bạn ở một mức cao hơn, đó là quản lý cluster với Docker Swarm kết hợp với Docker compose nhé!</p>
<p></p>

            </section>

        </article>
    </main>
    <footer class="page-footer">
        <h3>GMO-Z.com Vietnam Lab Center Technology Blog</h3>
            <p>Blog chia sẻ kỹ thuật của thành viên công ty GMO-Z.com Vietnam Lab Center</p>
        <p><a href="../../index.html">Read more posts →</a></p>
        <a class="powered" href="https://ghost.org" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 156 156"><g fill="none" fill-rule="evenodd"><rect fill="#15212B" width="156" height="156" rx="27"/><g transform="translate(36 36)" fill="#F6F8FA"><path d="M0 71.007A4.004 4.004 0 014 67h26a4 4 0 014 4.007v8.986A4.004 4.004 0 0130 84H4a4 4 0 01-4-4.007v-8.986zM50 71.007A4.004 4.004 0 0154 67h26a4 4 0 014 4.007v8.986A4.004 4.004 0 0180 84H54a4 4 0 01-4-4.007v-8.986z"/><rect y="34" width="84" height="17" rx="4"/><path d="M0 4.007A4.007 4.007 0 014.007 0h41.986A4.003 4.003 0 0150 4.007v8.986A4.007 4.007 0 0145.993 17H4.007A4.003 4.003 0 010 12.993V4.007z"/><rect x="67" width="17" height="17" rx="4"/></g></g></svg> Published with Ghost</a>
    </footer>
    
</body>
</html>
